const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CmuRsDk9.js","./index-DRz5BQNA.js","./index-BzItsYpE.js","./index-B3kPj2Rj.js","./index-DzaTm5oQ.css","./ExportBookmarksDialog-BqIde1JN.js","./MenuItem-D9_xBR9N.js","./dividerClasses-B-wJULXt.js","./DataGrid-Dgd1aEF_.js","./index-DqkJqhbV.js","./utils-BwPRrx3T.js","./getThemeProps-BbKRYxDH.js","./Divider-DCzRIyLN.js","./Badge-CuqxGOPa.js","./TableCell-AIVdwsWn.js","./ColorPicker-7FjqyIWY.js","./DataGridFlexContainer-B2hBWGBJ.js","./ImportBookmarksDialog-ZZ1ygHCP.js","./ExpandMore-BjLx39px.js","./Collapse-B0k2w5md.js","./sessionSharing-B3hY-33X.js","./AccordionDetails-BF2O2jir.js","./ShareBookmarksDialog-BeWFkaqe.js","./DialogContentText-BJzbeSoo.js","./HighlightSettingsDialog-CWcG6OGC.js","./useThemeProps-B1T1idtA.js","./EditHighlightColorDialog-BOHETAL_.js","./DeleteBookmarksDialog-0eQQtjjL.js"])))=>i.map(i=>d[i]);
import{aa as E,j as l,o as k,aj as v,cg as A,ak as D,C as g,ch as j,u as m,bs as y,_ as b,m as w,L as C,aM as B,ci as I,aN as L,aP as N,ce as T,cj as O,ck as V,cl as P,a as h}from"./index-B3kPj2Rj.js";import{M as x}from"./MenuItem-D9_xBR9N.js";import{L as S,D as $,G as R}from"./DataGrid-Dgd1aEF_.js";import{a as G}from"./ColorPicker-7FjqyIWY.js";import{D as M}from"./DataGridFlexContainer-B2hBWGBJ.js";const H=E(l.jsx("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92"})),W=k(function({model:n}){const{validAssemblies:t,selectedAssemblies:c}=n,i=t.size===0,u="Select assemblies",r="select-assemblies-label",a=new Set(c),o=[...t].every(s=>a.has(s));return l.jsxs(v,{disabled:i,fullWidth:!0,children:[l.jsx(A,{id:r,children:u}),l.jsxs(D,{labelId:r,multiple:!0,value:c,onChange:s=>{n.setSelectedAssemblies(typeof s.target.value=="string"?[s.target.value]:s.target.value)},input:l.jsx(j,{label:u}),renderValue:s=>s.join(", "),children:[l.jsxs(x,{onClickCapture:s=>{n.setSelectedAssemblies(o?[]:void 0),s.preventDefault()},children:[l.jsx(g,{checked:o,indeterminate:!o&&c.length>0}),l.jsx(S,{primary:"Select all"})]}),[...t].map(s=>l.jsxs(x,{value:s,children:[l.jsx(g,{checked:c.includes(s)}),l.jsx(S,{primary:s})]},s))]})]})});async function z(n,t,c,i){const u=m.getSession(i);try{let r=c.find(a=>a.id===u.focusedViewId);if(r?.assemblyNames[0]!==t&&(r=c.find(a=>a.type==="LinearGenomeView"&&a.assemblyNames[0]===t)),!r){const a=`${i.id}_${t}`;r=u.addView("LinearGenomeView",{id:a})}await r.navToLocString(n,t)}catch(r){console.error(r),u.notifyError(`${r}`,r)}}function le(n,t){const{selectedBookmarks:c,bookmarksWithValidAssemblies:i}=t,u=c.length===0?i:c;if(n==="BED"){const a={};for(const o of u){const{label:s}=o,d=s===""?".":s,e=`${o.refName}	${o.start}	${o.end}	${d}
`;a[o.assemblyName]?a[o.assemblyName].push(e):a[o.assemblyName]=[e]}for(const o in a){const s=a[o].reduce((p,f)=>p+f,""),d=new Blob([s||""],{type:"text/x-bed;charset=utf-8"}),e=`jbrowse_bookmarks_${o}.bed`;y.saveAs(d,e)}}else{const a=u.map(d=>{const{label:e}=d,p=e===""?".":e,f=m.assembleLocString(d);return`${d.refName}	${d.start+1}	${d.end}	${p}	${d.assemblyName}	${f}
`}).reduce((d,e)=>d+e,`chrom	start	end	label	assembly_name	coord_range
`),o=new Blob([a||""],{type:"text/tab-separated-values;charset=utf-8"});y.saveAs(o,"jbrowse_bookmarks.tsv")}}function q(n){let t=0;switch(n.length%4){case 3:t=1;break;case 2:t=2;break;case 0:t=0;break;default:throw new Error("base64 not a valid length")}return n+"=".repeat(t)}async function ne(n){const t=q(n.replaceAll("-","+").replaceAll("_","/")),{toByteArray:c}=await b(async()=>{const{toByteArray:a}=await import("./index-CmuRsDk9.js").then(o=>o.i);return{toByteArray:a}},__vite__mapDeps([0,1]),import.meta.url),{inflate:i}=await b(async()=>{const{inflate:a}=await import("./index-BzItsYpE.js").then(o=>o.i);return{inflate:a}},__vite__mapDeps([2,3,4]),import.meta.url),u=c(t),r=i(u);return new TextDecoder().decode(r)}async function ce(n){const t=new TextEncoder().encode(n),{deflate:c}=await b(async()=>{const{deflate:o}=await import("./index-BzItsYpE.js").then(s=>s.i);return{deflate:o}},__vite__mapDeps([2,3,4]),import.meta.url),{fromByteArray:i}=await b(async()=>{const{fromByteArray:o}=await import("./index-CmuRsDk9.js").then(s=>s.i);return{fromByteArray:o}},__vite__mapDeps([0,1]),import.meta.url),u=c(t),r=i(u),a=r.indexOf("=");return a>0?r.slice(0,a).replaceAll("+","-").replaceAll("/","_"):r.replaceAll("+","-").replaceAll("/","_")}const F=w()(()=>({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})),U=k(function({model:n}){const{classes:t}=F(),{bookmarks:c,bookmarksWithValidAssemblies:i,selectedAssemblies:u,selectedBookmarks:r}=n,a=m.getSession(n),o=new Set(u),s=c.filter(e=>o.has(e.assemblyName)).map((e,p)=>{const{assemblyName:f,..._}=e;return{...e,id:p,assemblyName:f,locString:m.assembleLocString(_),correspondingObj:e}}),d=[50,Math.max(m.measureText("Bookmark link",12)+30,m.measureGridWidth(s.map(e=>e.locString))),Math.max(m.measureText("Label",12)+30,m.measureGridWidth(s.map(e=>e.label))),Math.max(m.measureText("Assembly",12)+30,m.measureGridWidth(s.map(e=>e.assemblyName))),100];return l.jsx(M,{children:l.jsx($,{density:"compact",disableRowSelectionOnClick:!0,rows:s,columns:[{...R,width:d[0]},{field:"locString",headerName:"Bookmark link",width:d[1],renderCell:({value:e,row:p})=>l.jsx(C,{className:t.cell,href:"#",onClick:async f=>{f.preventDefault();const{views:_}=a;await z(e,p.assemblyName,_,n)},children:e})},{field:"label",headerName:"Label",width:d[2],editable:!0},{field:"assemblyName",headerName:"Assembly",width:d[3]},{field:"highlight",headerName:"Highlight",width:d[4],renderCell:({value:e,row:p})=>l.jsx(G,{color:e||"black",onChange:f=>{n.updateBookmarkHighlight(p,f)}})}],processRowUpdate:e=>{const p=s[e.id];return n.updateBookmarkLabel(p,e.label),e},onProcessRowUpdateError:e=>{a.notifyError(`${e}`,e)},checkboxSelection:!0,onRowSelectionModelChange:e=>{i.length>0&&n.setSelectedBookmarks([...e.ids].map(p=>({...s[p]})))},rowSelectionModel:{type:"include",ids:new Set(r.map(e=>e.id))}})})}),K=h.lazy(()=>b(()=>import("./ExportBookmarksDialog-BqIde1JN.js"),__vite__mapDeps([5,3,4,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url)),X=h.lazy(()=>b(()=>import("./ImportBookmarksDialog-ZZ1ygHCP.js"),__vite__mapDeps([17,3,4,18,19,20,21,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url)),J=h.lazy(()=>b(()=>import("./ShareBookmarksDialog-BeWFkaqe.js"),__vite__mapDeps([22,3,4,20,23,6,7,8,9,10,11,12,13,14,15,16]),import.meta.url)),Q=h.lazy(()=>b(()=>import("./HighlightSettingsDialog-CWcG6OGC.js"),__vite__mapDeps([24,3,4,11,25,8,9,10,6,7,12,13,14]),import.meta.url)),Y=h.lazy(()=>b(()=>import("./EditHighlightColorDialog-BOHETAL_.js"),__vite__mapDeps([26,3,4,15]),import.meta.url)),Z=h.lazy(()=>b(()=>import("./DeleteBookmarksDialog-0eQQtjjL.js"),__vite__mapDeps([27,3,4]),import.meta.url)),ee=w()({flex:{display:"flex"}}),te=k(function({model:t}){const{classes:c}=ee();return l.jsxs("div",{children:[l.jsxs(B,{severity:"info",children:["Click and type within the ",l.jsx("strong",{children:"label"})," field to annotate your bookmark"]}),l.jsxs("div",{className:c.flex,children:[l.jsx(I,{"data-testid":"grid_bookmark_menu",menuItems:[{label:"Export",icon:L,onClick:()=>{m.getSession(t).queueDialog(i=>[K,{onClose:i,model:t}])}},{label:"Import",icon:N,onClick:()=>{m.getSession(t).queueDialog(i=>[X,{model:t,onClose:i}])}},{label:"Delete",icon:T,onClick:()=>{m.getSession(t).queueDialog(i=>[Z,{model:t,onClose:i}])}},{label:"Share",icon:H,onClick:()=>{m.getSession(t).queueDialog(i=>[J,{model:t,onClose:i}])}},{label:"Edit colors",icon:O,onClick:()=>{m.getSession(t).queueDialog(i=>[Y,{model:t,onClose:i}])}},{label:"Settings",icon:V,onClick:()=>{m.getSession(t).queueDialog(i=>[Q,{model:t,onClose:i}])}}],children:l.jsx(P,{})}),l.jsx(W,{model:t})]}),l.jsx(U,{model:t})]})}),de=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{de as G,le as d,ne as f,ce as t};
//# sourceMappingURL=GridBookmarkWidget-DnLzP5C4.js.map
