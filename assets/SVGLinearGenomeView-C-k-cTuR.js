import{a2 as R,j as t,u as i,bQ as W,bR as $,bS as H,bT as A,z as O,t as G,b5 as L,c as N}from"./index-B3kPj2Rj.js";import{S as z,t as M,a as C}from"./util-CRVVJhFm.js";function D({width:e,height:s,shift:o}){const l=R();return t.jsx("rect",{width:e+o*2,height:s,fill:i.stripAlpha(l.palette.background.default)})}function J({model:e,fontSize:s}){const{offsetPx:o,dynamicBlocks:{totalWidthPxWithoutBorders:l,totalBp:m}}=e,c=R(),d=i.getBpDisplayStr(m),n=Math.max(-o,0),h=n+l,a=i.stripAlpha(c.palette.text.secondary),f=n+(h-n)/2,x=s;return t.jsxs(t.Fragment,{children:[t.jsx("line",{x1:n,x2:h,y1:10,y2:10,stroke:a}),t.jsx("line",{x1:n,x2:n,y1:5,y2:15,stroke:a}),t.jsx("line",{x1:h,x2:h,y1:5,y2:15,stroke:a}),t.jsx("text",{x:f,y:x,textAnchor:"middle",dominantBaseline:"hanging",fontSize:s,fill:a,children:d})]})}function I({model:e,fontSize:s,cytobandHeight:o,rulerHeight:l}){const{width:m,assemblyNames:c,showCytobands:d,displayedRegions:n}=e,{assemblyManager:h}=i.getSession(e),a=c.length>1?"":c[0],f=h.get(a),x=R(),j=i.stripAlpha(x.palette.text.primary),r=W.create({displayedRegions:JSON.parse(JSON.stringify(n)),interRegionPaddingWidth:0,minimumBlockWidth:e.minimumBlockWidth}),w=e.dynamicBlocks.contentBlocks;if(!w.length)return null;r.setVolatileWidth(m),r.showAllRegions();const k=r.dynamicBlocks.contentBlocks[0],g=w.at(0),p=w.at(-1),y=r.bpToPx({...g,coord:g.reversed?g.end:g.start})||0,v=r.bpToPx({...p,coord:p.reversed?p.start:p.end})||0,b=+d*o;return t.jsxs("g",{id:"header",children:[t.jsx("text",{x:0,y:0,dominantBaseline:"hanging",fontSize:s,fill:j,children:a}),d?t.jsxs("g",{transform:`translate(0 ${l})`,children:[t.jsx($,{overview:r,assembly:f,block:k}),t.jsx("rect",{stroke:"red",fill:"rgb(255,0,0)",fillOpacity:.1,width:Math.max(v-y,.5),height:H-1,x:y,y:.5}),t.jsx("g",{transform:`translate(0,${H})`,children:t.jsx(A,{overview:r,model:e,useOffset:!1})})]}):null,t.jsx("g",{transform:`translate(0 ${s+b})`,children:t.jsx(J,{model:e,fontSize:s})}),t.jsx("g",{transform:`translate(0 ${l+b})`,children:t.jsx(z,{model:e,fontSize:s})})]})}async function Q(e,s){await O(()=>e.initialized);const{textHeight:o=18,headerHeight:l=40,rulerHeight:m=50,fontSize:c=13,cytobandHeight:d=100,trackLabels:n="offset",themeName:h="default",Wrapper:a=({children:u})=>u}=s,f=i.getSession(e),{allThemes:x}=f,j=x?.()[h],{width:r,pinnedTracks:w,unpinnedTracks:k,tracks:g,showCytobands:p}=e,y=50,v=+p*d,b=l+m+v+10,S=M(g,o,n)+b+100,E=await Promise.all([...w,...k].map(async u=>{const P=u.displays[0];return await O(()=>!P.renderProps().notReady),{track:u,result:await P.renderSvg({...s,theme:j})}})),V=i.max(g.map(u=>i.measureText(G.getTrackName(u.configuration,f),c)),0)+40,B=n==="left"?V:0,T=r+B;return i.renderToStaticMarkup(t.jsx(L,{theme:N.createJBrowseTheme(j),children:t.jsx(a,{children:t.jsxs("svg",{width:T,height:S,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:[0,0,T+y*2,S].toString(),children:[t.jsx(D,{width:T,height:S,shift:y}),t.jsxs("g",{transform:`translate(${y} 0)`,children:[t.jsx("g",{transform:`translate(${B})`,children:t.jsx(I,{model:e,fontSize:c,rulerHeight:m,cytobandHeight:d})}),t.jsx("g",{transform:`translate(0 ${b})`,children:t.jsx(C,{textHeight:o,fontSize:c,model:e,displayResults:E,trackLabels:n,trackLabelOffset:B})})]})]})})}))}export{z as SVGRuler,C as SVGTracks,Q as renderToSvg};
//# sourceMappingURL=SVGLinearGenomeView-C-k-cTuR.js.map
