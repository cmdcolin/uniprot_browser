const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ModalWidget-BcjukJnr.js","./index-DPMJgfAS.js","./index-DHgBXOEh.css"])))=>i.map(i=>d[i]);
import{S as b,ck as C,o as p,m,a as c,j as e,P as W,am as g,cl as D,al as v,cm as k,aq as z,cn as I,u as y,ai as S,aj as T,T as x,cb as H,aR as _,aS as M,co as P,cp as F,c as w,_ as R}from"./index-DPMJgfAS.js";import{M as E}from"./MenuItem-BZgCoK98.js";import"./dividerClasses-CRpWzjDJ.js";var L=C();const f=b(L),N=m()(t=>({paper:{overflowY:"auto",height:"100%",position:"relative",zIndex:t.zIndex.drawer,outline:"none",background:t.palette.background.default},resizeHandle:{width:4,position:"fixed",top:0,zIndex:t.zIndex.drawer+1}})),V=p(function({children:t,session:n}){const{drawerPosition:s,drawerWidth:a}=n,{classes:i}=N(),r=c.useRef(null);return c.useEffect(()=>{function o(d){var l,u,h;if(d.target instanceof Element&&(!((l=r.current)===null||l===void 0)&&l.contains(d.target))){const j=(h=(u=n.visibleWidget)===null||u===void 0?void 0:u.view)===null||h===void 0?void 0:h.id;j&&n.setFocusedViewId(j)}}return document.addEventListener("mousedown",o),document.addEventListener("keydown",o),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("keydown",o)}},[n]),e.jsxs(W,{ref:r,className:i.paper,elevation:16,square:!0,children:[s==="right"?e.jsx(f,{onDrag:n.resizeDrawer,className:i.resizeHandle,vertical:!0}):null,t,s==="left"?e.jsx(f,{onDrag:n.resizeDrawer,className:i.resizeHandle,style:{left:a},vertical:!0}):null]})}),B=p(function({session:t}){const[n,s]=c.useState(null),{drawerPosition:a,visibleWidget:i}=t;return e.jsxs(e.Fragment,{children:[e.jsx(g,{color:"inherit",onClick:r=>{s(r.currentTarget)},children:e.jsx(D,{})}),e.jsx(v,{title:"Minimize drawer",children:e.jsx(g,{"data-testid":"drawer-minimize",color:"inherit",onClick:()=>{t.notify(`Drawer minimized, click button on ${a} side of screen to re-open`,"info"),t.minimizeWidgetDrawer()},children:e.jsx(k,{})})}),e.jsx(v,{title:"Close drawer",children:e.jsx(g,{color:"inherit",onClick:()=>{t.hideWidget(i)},children:e.jsx(z,{})})}),e.jsx(I,{anchorEl:n,open:!!n,onClose:()=>{s(null)},children:["left","right"].map(r=>e.jsx(E,{selected:a==="option",onClick:()=>{t.setDrawerPosition(r),s(null)},children:r},r))})]})}),$=m()(t=>({formControl:{margin:0},drawerSelect:{margin:0,color:t.palette.secondary.contrastText},dropDownIcon:{color:t.palette.secondary.contrastText}})),q=p(function({session:t}){const{visibleWidget:n,activeWidgets:s}=t,{classes:a}=$(),{pluginManager:i}=y.getEnv(t);return e.jsx(S,{className:a.formControl,children:e.jsx(T,{value:n?.id,"data-testid":"widget-drawer-selects",className:a.drawerSelect,classes:{icon:a.dropDownIcon},renderValue:r=>{const o=t.activeWidgets.get(r);if(!o)return e.jsx(x,{variant:"h6",color:"inherit",children:"Unknown widget"});const d=i.getWidgetType(o.type),{HeadingComponent:l,heading:u}=d;return l?e.jsx(l,{model:o}):e.jsx(x,{variant:"h6",color:"inherit",children:u})},onChange:r=>{const o=t.activeWidgets.get(r.target.value);o?t.showWidget(o):t.notify(`Widget not found ${r.target.value}`,"warning")},children:[...s.values()].map(r=>{const o=i.getWidgetType(r.type),{HeadingComponent:d,heading:l}=o;return e.jsxs(E,{"data-testid":`widget-drawer-selects-item-${r.type}`,value:r.id,children:[d?e.jsx(d,{model:r}):e.jsx(x,{variant:"h6",color:"inherit",children:l}),e.jsx(g,{"data-testid":`${r.type}-drawer-delete`,color:"inherit","aria-label":"Delete",onClick:()=>{t.hideWidget(r)},children:e.jsx(H,{})})]},r.id)})})})}),A=m()(t=>({spacer:{flexGrow:1},headerFocused:{background:t.palette.secondary.main},headerUnfocused:{background:t.palette.secondary.dark}})),O=p(function({session:t,setToolbarHeight:n,onPopoutDrawer:s}){var a,i;const{classes:r}=A(),o=t.focusedViewId,d=(i=(a=t.visibleWidget)===null||a===void 0?void 0:a.view)===null||i===void 0?void 0:i.id;return e.jsx(_,{position:"sticky",className:o===d?r.headerFocused:r.headerUnfocused,ref:l=>{n(l?.getBoundingClientRect().height||0)},children:e.jsxs(M,{disableGutters:!0,children:[e.jsx(q,{session:t}),e.jsx(v,{title:"Open drawer in dialog",children:e.jsx(g,{color:"inherit",onClick:()=>{s()},children:e.jsx(P,{})})}),e.jsx("div",{className:r.spacer}),e.jsx(B,{session:t})]})})}),U=c.lazy(()=>R(()=>import("./ModalWidget-BcjukJnr.js"),__vite__mapDeps([0,1,2]),import.meta.url)),K=p(function({session:t}){const{visibleWidget:n}=t,{pluginManager:s}=y.getEnv(t),a=n?s.evaluateExtensionPoint("Core-replaceWidget",s.getWidgetType(n.type).ReactComponent,{session:t,model:n}):null,[i,r]=c.useState(0),[o,d]=c.useState(!1);return e.jsxs(V,{session:t,children:[e.jsx(O,{onPopoutDrawer:()=>{d(!0)},session:t,setToolbarHeight:r}),e.jsx(c.Suspense,{fallback:e.jsx(w.LoadingEllipses,{}),children:e.jsx(F.ErrorBoundary,{FallbackComponent:({error:l})=>e.jsx(w.ErrorMessage,{error:l}),children:a?o?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Opened in dialog..."}),e.jsx(U,{session:t,onClose:()=>{d(!1)}})]}):e.jsxs(e.Fragment,{children:[e.jsx(a,{model:n,session:t,toolbarHeight:i}),e.jsx("div",{style:{height:300}})]}):null})})]})});export{K as default};
//# sourceMappingURL=DrawerWidget-Cwoe-iI8.js.map
