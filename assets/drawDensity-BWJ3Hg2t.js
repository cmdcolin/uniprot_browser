import{y as c,az as S,Z as T,u as j,aB as y}from"./index-DPMJgfAS.js";const k=.3,x=2;function D(t,E){const{stopToken:u,features:g,regions:I,bpPerPx:d,scaleOpts:s,height:i,config:n}=E,C=I[0],M=c.readConfObject(n,"bicolorPivot"),N=c.readConfObject(n,"bicolorPivotValue"),V=c.readConfObject(n,"negColor"),b=c.readConfObject(n,"posColor"),F=c.readConfObject(n,"color"),R=c.readConfObject(n,"clipColor"),h=M!=="none"&&s.scaleType!=="log",_=S({...s,pivotValue:h?N:void 0,range:h?[V,"#eee",b]:["#eee",b]}),z=S({...s,range:[0,i]}),A=F==="#f0f"?(o,e)=>_(e):(o,e)=>c.readConfObject(n,"color",{feature:o,score:e}),m=z.domain(),P=m[0],v=m[1];let w=Number.NEGATIVE_INFINITY,p=!1;const O=[];let a=performance.now();for(const o of g.values()){performance.now()-a>400&&(T.checkStopToken(u),a=performance.now());const[e,f]=j.featureSpanPx(o,C,d);(Math.floor(e)!==Math.floor(w)||f-e>1)&&(O.push(o),w=e);const r=o.get("score");p=p||r>v||r<P;const l=f-e+k;r>=s.domain[0]?(t.fillStyle=A(o,r),t.fillRect(e,0,l,i)):(t.fillStyle="#eee",t.fillRect(e,0,l,i))}if(t.save(),p){t.fillStyle=R;for(const o of g.values()){performance.now()-a>400&&(T.checkStopToken(u),a=performance.now());const[e,f]=j.featureSpanPx(o,C,d),r=f-e+k,l=o.get("score");l>v?y(e,0,r,x,t):l<P&&s.scaleType!=="log"&&y(e,0,r,x,t)}}return t.restore(),{reducedFeatures:O}}export{D as drawDensity};
//# sourceMappingURL=drawDensity-BWJ3Hg2t.js.map
