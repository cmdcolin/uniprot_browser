{"version":3,"file":"renderSvg-DEGmCgEX.js","sources":["../../node_modules/@jbrowse/plugin-linear-genome-view/esm/BaseLinearDisplay/models/renderSvg.js"],"sourcesContent":["import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment } from 'react';\nimport { ReactRendering, getContainingView, getViewParams, } from '@jbrowse/core/util';\nimport BlockState, { renderBlockData } from './serverSideRenderedBlock';\nimport { getId } from './util';\nexport async function renderBaseLinearDisplaySvg(self, opts) {\n    const { height, id } = self;\n    const { overrideHeight } = opts;\n    const view = getContainingView(self);\n    const { offsetPx: viewOffsetPx, roundedDynamicBlocks, width } = view;\n    const renderings = await Promise.all(roundedDynamicBlocks.map(async (block) => {\n        const blockState = BlockState.create({\n            key: block.key,\n            region: block,\n        });\n        const cannotBeRenderedReason = self.regionCannotBeRenderedText(block) ||\n            self.regionCannotBeRendered(block);\n        if (cannotBeRenderedReason) {\n            return [\n                block,\n                {\n                    reactElement: (_jsxs(_Fragment, { children: [_jsx(\"rect\", { x: 0, y: 0, width: width, height: 20, fill: \"#aaa\" }), _jsx(\"text\", { x: 0, y: 15, children: cannotBeRenderedReason })] })),\n                },\n            ];\n        }\n        const { rpcManager, renderArgs, renderProps, rendererType } = renderBlockData(blockState, self);\n        return [\n            block,\n            await rendererType.renderInClient(rpcManager, {\n                ...renderArgs,\n                ...renderProps,\n                viewParams: getViewParams(self, true),\n                exportSVG: opts,\n                theme: opts.theme || renderProps.theme,\n            }),\n        ];\n    }));\n    return (_jsx(_Fragment, { children: renderings.map(([block, rendering], index) => {\n            const { offsetPx, widthPx } = block;\n            const offset = offsetPx - viewOffsetPx;\n            const clipid = getId(id, index);\n            return (_jsxs(Fragment, { children: [_jsx(\"defs\", { children: _jsx(\"clipPath\", { id: clipid, children: _jsx(\"rect\", { x: 0, y: 0, width: widthPx, height: overrideHeight || height }) }) }), _jsx(\"g\", { transform: `translate(${offset} 0)`, children: _jsx(\"g\", { clipPath: `url(#${clipid})`, children: _jsx(ReactRendering, { rendering: rendering }) }) })] }, `frag-${index}`));\n        }) }));\n}\n"],"names":["renderBaseLinearDisplaySvg","self","opts","height","id","overrideHeight","view","getContainingView","viewOffsetPx","roundedDynamicBlocks","width","renderings","block","blockState","BlockState","cannotBeRenderedReason","_jsxs","_Fragment","_jsx","rpcManager","renderArgs","renderProps","rendererType","renderBlockData","getViewParams","rendering","index","offsetPx","widthPx","offset","clipid","getId","Fragment","ReactRendering"],"mappings":"2EAKO,eAAeA,EAA2BC,EAAMC,EAAM,CACzD,KAAM,CAAE,OAAAC,EAAQ,GAAAC,CAAE,EAAKH,EACjB,CAAE,eAAAI,CAAc,EAAKH,EACrBI,EAAOC,EAAAA,kBAAkBN,CAAI,EAC7B,CAAE,SAAUO,EAAc,qBAAAC,EAAsB,MAAAC,CAAK,EAAKJ,EAC1DK,EAAa,MAAM,QAAQ,IAAIF,EAAqB,IAAI,MAAOG,GAAU,CAC3E,MAAMC,EAAaC,EAAW,OAAO,CACjC,IAAKF,EAAM,IACX,OAAQA,CACpB,CAAS,EACKG,EAAyBd,EAAK,2BAA2BW,CAAK,GAChEX,EAAK,uBAAuBW,CAAK,EACrC,GAAIG,EACA,MAAO,CACHH,EACA,CACI,aAAeI,EAAAA,KAAMC,EAAAA,SAAW,CAAE,SAAU,CAACC,EAAAA,IAAK,OAAQ,CAAE,EAAG,EAAG,EAAG,EAAG,MAAOR,EAAO,OAAQ,GAAI,KAAM,MAAM,CAAE,EAAGQ,EAAAA,IAAK,OAAQ,CAAE,EAAG,EAAG,EAAG,GAAI,SAAUH,CAAsB,CAAE,CAAC,CAAC,CAAE,CACzM,CACA,EAEQ,KAAM,CAAE,WAAAI,EAAY,WAAAC,EAAY,YAAAC,EAAa,aAAAC,CAAY,EAAKC,EAAgBV,EAAYZ,CAAI,EAC9F,MAAO,CACHW,EACA,MAAMU,EAAa,eAAeH,EAAY,CAC1C,GAAGC,EACH,GAAGC,EACH,WAAYG,EAAAA,cAAcvB,EAAM,EAAI,EACpC,UAAWC,EACX,MAAOA,EAAK,OAASmB,EAAY,KACjD,CAAa,CACb,CACI,CAAC,CAAC,EACF,OAAQH,MAAKD,EAAAA,SAAW,CAAE,SAAUN,EAAW,IAAI,CAAC,CAACC,EAAOa,CAAS,EAAGC,IAAU,CAC1E,KAAM,CAAE,SAAAC,EAAU,QAAAC,CAAO,EAAKhB,EACxBiB,EAASF,EAAWnB,EACpBsB,EAASC,EAAM3B,EAAIsB,CAAK,EAC9B,OAAQV,EAAAA,KAAMgB,EAAAA,SAAU,CAAE,SAAU,CAACd,EAAAA,IAAK,OAAQ,CAAE,SAAUA,EAAAA,IAAK,WAAY,CAAE,GAAIY,EAAQ,SAAUZ,MAAK,OAAQ,CAAE,EAAG,EAAG,EAAG,EAAG,MAAOU,EAAS,OAAQvB,GAAkBF,CAAM,CAAE,CAAC,CAAE,CAAC,CAAE,EAAGe,MAAK,IAAK,CAAE,UAAW,aAAaW,CAAM,MAAO,SAAUX,EAAAA,IAAK,IAAK,CAAE,SAAU,QAAQY,CAAM,IAAK,SAAUZ,EAAAA,IAAKe,EAAAA,eAAgB,CAAE,UAAWR,CAAS,CAAE,EAAG,CAAC,CAAE,CAAC,CAAC,EAAI,QAAQC,CAAK,EAAE,CACvX,CAAC,CAAC,CAAE,CACZ","x_google_ignoreList":[0]}