import{o as L,m as N,a as m,u as D,j as e,c as h,D as T,T as x,d as w,e as F,B as y,ag as W,aN as v,aO as C}from"./index-DPMJgfAS.js";import{A as S,a as g,E as j}from"./ExpandMore-BvgaQCbI.js";import{r as P}from"./sessionSharing-DTJt6fso.js";import{f as R}from"./GridBookmarkWidget-DrjMH57G.js";import{A as b}from"./AccordionDetails-BjkwOWXZ.js";import"./Collapse-Bv0zK0p9.js";import"./MenuItem-BZgCoK98.js";import"./dividerClasses-CRpWzjDJ.js";import"./DataGrid-BbeQwLC2.js";import"./index-BHGTJiUw.js";import"./utils-DSyQ0Yxy.js";import"./getThemeProps-D2Hd2SEb.js";import"./Divider-BsNHrm83.js";import"./Badge-HDwRQZRU.js";import"./TableCell-CTZZHzq1.js";import"./ColorPicker-DOkiVKNe.js";import"./DataGridFlexContainer-B8arD5BB.js";const U=N()(s=>({expandIcon:{color:s.palette.tertiary.contrastText||"#fff"},minWidth:{minWidth:500}}));async function V(s,t){const a="https://share.jbrowse.org/api/v1/",r=new URL(s),i=r.searchParams.get("bookmarks"),o=r.searchParams.get("password"),n=await P(`${t??a}load`,i||"",o||"");return JSON.parse(await R(n)).sharedBookmarks}function M(s){return s.startsWith("chrom")&&s.includes("assembly_name")?"TSV":"BED"}async function O(s){return s[0].startsWith("chrom")&&(s=s.slice(1)),s.filter(t=>!t.startsWith("#")).map(t=>{const[a,r,i,o,n]=t.split("	");return{assemblyName:n,refName:a,start:+r,end:+i,label:o==="."?void 0:o}})}async function _(s,t){return s.filter(a=>!a.startsWith("#")).map(a=>{const[r,i,o,n]=a.split("	");return{assemblyName:t,refName:r,start:+i,end:+o,label:n==="."?void 0:n}})}const ie=L(function({onClose:s,model:t}){const{classes:a}=U(),[r,i]=m.useState(),[o,n]=m.useState(),[l,E]=m.useState(""),d=D.getSession(t),{assemblyNames:A}=d,[u,B]=m.useState(A[0]),[p,k]=m.useState("shareLinkAccordion");return e.jsxs(h.Dialog,{open:!0,onClose:s,maxWidth:"xl",title:"Import bookmarks",children:[e.jsxs(T,{className:a.minWidth,children:[e.jsxs(S,{expanded:p==="shareLinkAccordion",onChange:()=>{k("shareLinkAccordion")},children:[e.jsx(g,{expandIcon:e.jsx(j,{className:a.expandIcon}),children:e.jsx(x,{style:{display:"flex",alignItems:"center",gap:"5px"},children:"Import from share link"})}),e.jsxs(b,{children:[e.jsx(x,{children:"Paste a bookmark share link generated by the 'Share' button from the bookmarks widget"}),e.jsx(w,{label:"Enter Share URL",variant:"outlined",fullWidth:!0,value:l,onChange:c=>{E(c.target.value)}})]})]}),e.jsxs(S,{expanded:p==="fileAccordion",onChange:()=>{k("fileAccordion")},children:[e.jsx(g,{expandIcon:e.jsx(j,{className:a.expandIcon}),children:e.jsx(x,{children:"Import from file"})}),e.jsxs(b,{children:[e.jsx(h.FileSelector,{location:r,setLocation:i,name:"File",description:'Choose a BED or TSV format file to import. Required TSV column headers are "chrom, start, end, label, assembly_name".'}),e.jsx(h.AssemblySelector,{onChange:c=>{B(c)},helperText:"Select the assembly for BED file.",session:d,selected:u})]})]}),o?e.jsx(h.ErrorMessage,{error:o}):null]}),e.jsxs(F,{children:[e.jsx(y,{variant:"contained",color:"secondary",onClick:s,children:"Cancel"}),e.jsx(y,{"data-testid":"dialogImport",variant:"contained",color:"primary",disabled:!r&&!l,startIcon:e.jsx(C,{}),onClick:async()=>{try{if(p==="fileAccordion"&&r){const f=(await W.openLocation(r).readFile("utf8")).split(/\n|\r\n|\r/).filter(I=>!!I.trim());M(f[0])==="BED"?t.importBookmarks(await _(f,u)):t.importBookmarks(await O(f))}else p==="shareLinkAccordion"&&l&&v.isSessionWithShareURL(d)&&t.importBookmarks(await V(l,d.shareURL));s()}catch(c){console.error(c),n(c)}},children:"Import"})]})]})});export{ie as default};
//# sourceMappingURL=ImportBookmarksDialog-BW-2Tgci.js.map
