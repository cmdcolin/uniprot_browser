{"version":3,"file":"BedImport-y3hsRuLM.js","sources":["../../node_modules/@jbrowse/plugin-spreadsheet-view/esm/SpreadsheetView/importAdapters/BedImport.js"],"sourcesContent":["import { isNumber } from './isNumber';\nimport { bufferToLines, parseStrand } from './util';\nexport function parseBedBuffer(buffer) {\n    var _a, _b;\n    const lines = bufferToLines(buffer);\n    const rest = lines.filter(line => !(line.startsWith('#') ||\n        line.startsWith('browser') ||\n        line.startsWith('track')));\n    const lastHeaderLine = lines.findLast(line => line.startsWith('#'));\n    const coreColumns = ['refName', 'start', 'end'];\n    const numExtraColumns = Math.max(0, (((_b = (_a = rest[0]) === null || _a === void 0 ? void 0 : _a.split('\\t')) === null || _b === void 0 ? void 0 : _b.length) || 0) - coreColumns.length);\n    const extraNames = (lastHeaderLine === null || lastHeaderLine === void 0 ? void 0 : lastHeaderLine.includes('\\t'))\n        ? lastHeaderLine\n            .slice(1)\n            .split('\\t')\n            .slice(coreColumns.length)\n            .map(t => t.trim())\n        : Array.from({ length: numExtraColumns }, (_v, i) => `field_${i}`);\n    const colNames = [...coreColumns, ...extraNames];\n    return {\n        columns: colNames.map(c => ({ name: c })),\n        rowSet: {\n            rows: rest.map((line, idx) => {\n                const cols = line.split('\\t');\n                return {\n                    cellData: {\n                        refName: cols[0],\n                        start: +cols[1],\n                        end: +cols[2],\n                        name: cols[3],\n                        score: cols[4],\n                        strand: cols[5],\n                        ...Object.fromEntries(extraNames.map((n, idx) => {\n                            const r = cols[idx + coreColumns.length];\n                            return [n, isNumber(r) ? +r : r];\n                        })),\n                    },\n                    feature: {\n                        uniqueId: `bed-${idx}`,\n                        refName: cols[0],\n                        start: +cols[1],\n                        end: +cols[2],\n                        name: cols[3],\n                        score: cols[4],\n                        strand: parseStrand(cols[5]),\n                        ...Object.fromEntries(extraNames.map((n, idx) => {\n                            const r = cols[idx + coreColumns.length];\n                            return [n, isNumber(r) ? +r : r];\n                        })),\n                    },\n                };\n            }),\n        },\n    };\n}\n"],"names":["parseBedBuffer","buffer","_a","_b","lines","bufferToLines","rest","line","lastHeaderLine","coreColumns","numExtraColumns","extraNames","t","_v","i","c","idx","cols","n","isNumber","parseStrand"],"mappings":"oFAEO,SAASA,EAAeC,EAAQ,CACnC,IAAIC,EAAIC,EACR,MAAMC,EAAQC,EAAcJ,CAAM,EAC5BK,EAAOF,EAAM,OAAOG,GAAQ,EAAEA,EAAK,WAAW,GAAG,GACnDA,EAAK,WAAW,SAAS,GACzBA,EAAK,WAAW,OAAO,EAAE,EACvBC,EAAiBJ,EAAM,SAASG,GAAQA,EAAK,WAAW,GAAG,CAAC,EAC5DE,EAAc,CAAC,UAAW,QAAS,KAAK,EACxCC,EAAkB,KAAK,IAAI,KAAMP,GAAMD,EAAKI,EAAK,CAAC,KAAO,MAAQJ,IAAO,OAAS,OAASA,EAAG,MAAM,GAAI,KAAO,MAAQC,IAAO,OAAS,OAASA,EAAG,SAAW,GAAKM,EAAY,MAAM,EACpLE,EAAcH,GAAmB,MAA6CA,EAAe,SAAS,GAAI,EAC1GA,EACG,MAAM,CAAC,EACP,MAAM,GAAI,EACV,MAAMC,EAAY,MAAM,EACxB,IAAIG,GAAKA,EAAE,KAAM,CAAA,EACpB,MAAM,KAAK,CAAE,OAAQF,CAAiB,EAAE,CAACG,EAAIC,IAAM,SAASA,CAAC,EAAE,EAErE,MAAO,CACH,QAFa,CAAC,GAAGL,EAAa,GAAGE,CAAU,EAEzB,IAAII,IAAM,CAAE,KAAMA,CAAC,EAAG,EACxC,OAAQ,CACJ,KAAMT,EAAK,IAAI,CAACC,EAAMS,IAAQ,CAC1B,MAAMC,EAAOV,EAAK,MAAM,GAAI,EAC5B,MAAO,CACH,SAAU,CACN,QAASU,EAAK,CAAC,EACf,MAAO,CAACA,EAAK,CAAC,EACd,IAAK,CAACA,EAAK,CAAC,EACZ,KAAMA,EAAK,CAAC,EACZ,MAAOA,EAAK,CAAC,EACb,OAAQA,EAAK,CAAC,EACd,GAAG,OAAO,YAAYN,EAAW,IAAI,CAACO,EAAGF,IAAQ,CAC7C,MAAM,EAAIC,EAAKD,EAAMP,EAAY,MAAM,EACvC,MAAO,CAACS,EAAGC,EAAS,CAAC,EAAI,CAAC,EAAI,CAAC,CAC3D,CAAyB,CAAC,CACL,EACD,QAAS,CACL,SAAU,OAAOH,CAAG,GACpB,QAASC,EAAK,CAAC,EACf,MAAO,CAACA,EAAK,CAAC,EACd,IAAK,CAACA,EAAK,CAAC,EACZ,KAAMA,EAAK,CAAC,EACZ,MAAOA,EAAK,CAAC,EACb,OAAQG,EAAYH,EAAK,CAAC,CAAC,EAC3B,GAAG,OAAO,YAAYN,EAAW,IAAI,CAACO,EAAGF,IAAQ,CAC7C,MAAM,EAAIC,EAAKD,EAAMP,EAAY,MAAM,EACvC,MAAO,CAACS,EAAGC,EAAS,CAAC,EAAI,CAAC,EAAI,CAAC,CAC3D,CAAyB,CAAC,CACL,CACJ,CACjB,CAAa,CACJ,CACJ,CACL","x_google_ignoreList":[0]}