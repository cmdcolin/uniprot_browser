{"version":3,"file":"Overlay-B_J5SEvN.js","sources":["../../node_modules/@jbrowse/plugin-breakpoint-split-view/esm/BreakpointSplitView/components/util.js","../../node_modules/@jbrowse/plugin-breakpoint-split-view/esm/BreakpointSplitView/components/getOrientationColor.js","../../node_modules/@jbrowse/plugin-breakpoint-split-view/esm/BreakpointSplitView/components/AlignmentConnections.js","../../node_modules/@jbrowse/plugin-breakpoint-split-view/esm/BreakpointSplitView/components/Breakends.js","../../node_modules/@jbrowse/plugin-breakpoint-split-view/esm/BreakpointSplitView/components/PairedFeatures.js","../../node_modules/@jbrowse/plugin-breakpoint-split-view/esm/BreakpointSplitView/components/Translocations.js","../../node_modules/@jbrowse/plugin-breakpoint-split-view/esm/BreakpointSplitView/components/Overlay.js"],"sourcesContent":["import { parseBreakend } from '@gmod/vcf';\nimport { assembleLocStringFast, notEmpty } from '@jbrowse/core/util';\nexport function getBadlyPairedAlignments(features) {\n    const candidates = new Map();\n    const alreadySeen = new Set();\n    const alreadyPairedWithSamePosition = new Set();\n    for (const feature of features.values()) {\n        const flags = feature.get('flags');\n        const id = feature.id();\n        const supp = assembleLocStringFast({\n            refName: feature.get('refName'),\n            start: feature.get('start'),\n            end: feature.get('end'),\n        });\n        const unmapped = flags & 4;\n        const correctlyPaired = flags & 2;\n        if (!alreadySeen.has(id) &&\n            !alreadyPairedWithSamePosition.has(supp) &&\n            !correctlyPaired &&\n            !unmapped) {\n            const n = feature.get('name');\n            let val = candidates.get(n);\n            if (!val) {\n                val = [];\n                candidates.set(n, val);\n            }\n            val.push(feature);\n        }\n        alreadySeen.add(feature.id());\n        alreadyPairedWithSamePosition.add(supp);\n    }\n    return [...candidates.values()].filter(v => v.length > 1);\n}\nexport function getMatchedAlignmentFeatures(features) {\n    var _a;\n    const candidates = new Map();\n    const alreadySeen = new Set();\n    for (const feature of features.values()) {\n        const id = feature.id();\n        const unmapped = feature.get('flags') & 4;\n        const hasSA = !!((_a = feature.get('tags')) === null || _a === void 0 ? void 0 : _a.SA);\n        if (!alreadySeen.has(id) && !unmapped && hasSA) {\n            const n = feature.get('name');\n            let val = candidates.get(n);\n            if (!val) {\n                val = [];\n                candidates.set(n, val);\n            }\n            val.push(feature);\n        }\n        alreadySeen.add(feature.id());\n    }\n    return [...candidates.values()].filter(v => v.length > 1);\n}\nexport function hasPairedReads(features) {\n    for (const f of features.values()) {\n        if (f.get('flags') & 1) {\n            return true;\n        }\n    }\n    return false;\n}\nexport function findMatchingAlt(feat1, feat2) {\n    const alts = feat1.get('ALT');\n    if (alts) {\n        return new Map(alts\n            .map(alt => parseBreakend(alt))\n            .filter(notEmpty)\n            .map(bnd => [bnd.MatePosition, bnd])).get(`${feat2.get('refName')}:${feat2.get('start') + 1}`);\n    }\n    return undefined;\n}\nexport function getMatchedBreakendFeatures(feats) {\n    const candidates = new Map();\n    const alreadySeen = new Set();\n    for (const f of feats.values()) {\n        if (!alreadySeen.has(f.id()) && f.get('type') === 'breakend') {\n            const alts = f.get('ALT');\n            if (alts) {\n                for (const a of alts) {\n                    const cur = `${f.get('refName')}:${f.get('start') + 1}`;\n                    const bnd = parseBreakend(a);\n                    if (bnd) {\n                        const val = candidates.get(cur);\n                        if (!val) {\n                            candidates.set(bnd.MatePosition || 'none', [f]);\n                        }\n                        else {\n                            val.push(f);\n                        }\n                    }\n                }\n            }\n        }\n        alreadySeen.add(f.id());\n    }\n    return [...candidates.values()].filter(v => v.length > 1);\n}\nexport function getMatchedTranslocationFeatures(feats) {\n    const ret = [];\n    const alreadySeen = new Set();\n    for (const f of feats.values()) {\n        if (!alreadySeen.has(f.id()) && f.get('ALT')[0] === '<TRA>') {\n            ret.push([f]);\n        }\n        alreadySeen.add(f.id());\n    }\n    return ret;\n}\nexport function getMatchedPairedFeatures(feats) {\n    const candidates = new Map();\n    const alreadySeen = new Set();\n    for (const f of feats.values()) {\n        if (!alreadySeen.has(f.id()) && f.get('type') === 'paired_feature') {\n            const r1 = f.id().replace('-r1', '');\n            const r2 = f.id().replace('-r2', '');\n            if (f.id().endsWith('-r1')) {\n                if (!candidates.get(r1)) {\n                    candidates.set(r1, []);\n                }\n                candidates.get(r1).push(f);\n            }\n            else if (f.id().endsWith('-r2')) {\n                if (!candidates.get(r2)) {\n                    candidates.set(r2, []);\n                }\n                candidates.get(r2).push(f);\n            }\n        }\n        alreadySeen.add(f.id());\n    }\n    return [...candidates.values()].filter(v => v.length > 1);\n}\n","import { alpha } from '@mui/material';\nexport const orientationTypes = {\n    fr: {\n        F1R2: 'LR',\n        F2R1: 'LR',\n        F1F2: 'LL',\n        F2F1: 'LL',\n        R1R2: 'RR',\n        R2R1: 'RR',\n        R1F2: 'RL',\n        R2F1: 'RL',\n    },\n    rf: {\n        R1F2: 'LR',\n        R2F1: 'LR',\n        R1R2: 'LL',\n        R2R1: 'LL',\n        F1F2: 'RR',\n        F2F1: 'RR',\n        F1R2: 'RL',\n        F2R1: 'RL',\n    },\n    ff: {\n        F2F1: 'LR',\n        R1R2: 'LR',\n        F2R1: 'LL',\n        R1F2: 'LL',\n        R2F1: 'RR',\n        F1R2: 'RR',\n        R2R1: 'RL',\n        F1F2: 'RL',\n    },\n};\nexport const pairMap = {\n    LR: 'color_pair_lr',\n    LL: 'color_pair_ll',\n    RR: 'color_pair_rr',\n    RL: 'color_pair_rl',\n};\nexport const strokeColor = {\n    color_fwd_strand_not_proper: alpha('#CA6767', 0.8),\n    color_rev_strand_not_proper: alpha('#7272AA', 0.8),\n    color_fwd_strand: alpha('#DC2A2A', 0.8),\n    color_rev_strand: alpha('#4141BA', 0.8),\n    color_fwd_missing_mate: alpha('#921111', 0.8),\n    color_rev_missing_mate: alpha('#111192', 0.8),\n    color_fwd_diff_chr: alpha('#000000', 0.8),\n    color_rev_diff_chr: alpha('#696969', 0.8),\n    color_pair_lr: alpha('#8C8C8C', 0.8),\n    color_pair_rr: alpha('#00005A', 0.8),\n    color_pair_rl: alpha('#005A5A', 0.8),\n    color_pair_ll: alpha('#005A00', 0.8),\n    color_nostrand: alpha('#8C8C8C', 0.8),\n    color_interchrom: alpha('#5A005A', 0.8),\n    color_longinsert: alpha('#B30000', 0.8),\n    color_shortinsert: alpha('#FF3A5C', 0.8),\n    color_unknown: alpha('#555', 0.8),\n};\nconst defaultColor = strokeColor.color_unknown;\nexport function getPairedOrientationColorOrDefault(f) {\n    const type = orientationTypes.fr;\n    const r = type[f.pair_orientation || ''];\n    const type2 = pairMap[r];\n    return r === 'LR' ? undefined : strokeColor[type2];\n}\nexport function getLongReadOrientationColorOrDefault(s1, s2) {\n    if (s1 === -1 && s2 === 1) {\n        return strokeColor.color_pair_rr;\n    }\n    else if (s1 === 1 && s2 === -1) {\n        return strokeColor.color_pair_ll;\n    }\n    else {\n        return strokeColor.color_unknown;\n    }\n}\nexport function getLongReadOrientationAbnormal(s1, s2) {\n    if (s1 === -1 && s2 === 1) {\n        return true;\n    }\n    else if (s1 === 1 && s2 === -1) {\n        return true;\n    }\n    else {\n        return false;\n    }\n}\nexport function isAbnormalOrientation(f) {\n    const type = orientationTypes.fr;\n    const r = type[f.pair_orientation || ''];\n    return r !== 'LR';\n}\nexport function getPairedOrientationColor(f) {\n    return getPairedOrientationColorOrDefault(f) || defaultColor;\n}\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useMemo, useState } from 'react';\nimport { getSession, getStrokeProps } from '@jbrowse/core/util';\nimport { useTheme } from '@mui/material';\nimport { observer } from 'mobx-react';\nimport { getSnapshot } from 'mobx-state-tree';\nimport { getBadlyPairedAlignments, getMatchedAlignmentFeatures, hasPairedReads, } from './util';\nimport { getPxFromCoordinate, heightFromSpecificLevel, useNextFrame, yPos, } from '../util';\nimport { getLongReadOrientationAbnormal, getLongReadOrientationColorOrDefault, getPairedOrientationColor, isAbnormalOrientation, } from './getOrientationColor';\nconst [LEFT, , RIGHT] = [0, 1, 2, 3];\nconst AlignmentConnections = observer(function ({ model, trackId, parentRef, getTrackYPosOverride, }) {\n    const { interactiveOverlay, views, showIntraviewLinks } = model;\n    const theme = useTheme();\n    const session = getSession(model);\n    const snap = getSnapshot(model);\n    const { assemblyManager } = session;\n    const v0 = views[0];\n    const assembly = v0 ? assemblyManager.get(v0.assemblyNames[0]) : undefined;\n    useNextFrame(snap);\n    const allFeatures = model.getTrackFeatures(trackId);\n    const hasPaired = useMemo(() => hasPairedReads(allFeatures), [allFeatures]);\n    const layoutMatches = useMemo(() => {\n        const layoutMatches = model.getMatchedFeaturesInLayout(trackId, hasPaired\n            ? getBadlyPairedAlignments(allFeatures)\n            : getMatchedAlignmentFeatures(allFeatures));\n        if (!hasPaired) {\n            for (const m of layoutMatches) {\n                m.sort((a, b) => a.clipPos - b.clipPos);\n            }\n        }\n        return layoutMatches;\n    }, [allFeatures, trackId, hasPaired, model]);\n    const [mouseoverElt, setMouseoverElt] = useState();\n    let yOffset = 0;\n    if (parentRef.current) {\n        const rect = parentRef.current.getBoundingClientRect();\n        yOffset = rect.top;\n    }\n    return assembly ? (_jsx(\"g\", { fill: \"none\", \"data-testid\": layoutMatches.length ? `${trackId}-loaded` : trackId, children: layoutMatches.map(chunk => {\n            const ret = [];\n            for (let i = 0; i < chunk.length - 1; i++) {\n                const { layout: c1, feature: f1, level: level1 } = chunk[i];\n                const { layout: c2, feature: f2, level: level2 } = chunk[i + 1];\n                if (!c1 || !c2) {\n                    console.warn('received null layout for a overlay feature');\n                    return null;\n                }\n                if (!showIntraviewLinks && level1 === level2) {\n                    return null;\n                }\n                const f1ref = assembly.getCanonicalRefName(f1.get('refName'));\n                const f2ref = assembly.getCanonicalRefName(f2.get('refName'));\n                if (!f1ref || !f2ref) {\n                    throw new Error(`unable to find ref for ${f1ref || f2ref}`);\n                }\n                const r = {\n                    pair_orientation: f1.get('pair_orientation'),\n                };\n                const s1 = f1.get('strand');\n                const s2 = f2.get('strand');\n                const sameRef = f1ref === f2ref;\n                const checkOrientation = sameRef;\n                let orientationColor = '';\n                let isAbnormal = false;\n                if (checkOrientation) {\n                    if (hasPaired) {\n                        orientationColor = getPairedOrientationColor(r);\n                        isAbnormal = isAbnormalOrientation(r);\n                    }\n                    else {\n                        orientationColor = getLongReadOrientationColorOrDefault(s1, s2);\n                        isAbnormal = getLongReadOrientationAbnormal(s1, s2);\n                    }\n                }\n                const p1 = c1[s1 === -1 ? LEFT : RIGHT];\n                const sn1 = s2 === -1;\n                const p2 = hasPaired ? c2[sn1 ? LEFT : RIGHT] : c2[sn1 ? RIGHT : LEFT];\n                const x1 = getPxFromCoordinate(views[level1], f1ref, p1);\n                const x2 = getPxFromCoordinate(views[level2], f2ref, p2);\n                const reversed1 = views[level1].pxToBp(x1).reversed;\n                const reversed2 = views[level2].pxToBp(x2).reversed;\n                const rf1 = reversed1 ? -1 : 1;\n                const rf2 = reversed2 ? -1 : 1;\n                const tracks = views.map(v => v.getTrack(trackId));\n                const y1 = yPos(trackId, level1, views, tracks, c1, getTrackYPosOverride) -\n                    yOffset;\n                const y2 = yPos(trackId, level2, views, tracks, c2, getTrackYPosOverride) -\n                    yOffset;\n                const sameLevel = level1 === level2;\n                const abnormalSpecialRenderFlag = sameLevel && isAbnormal;\n                const trackHeight = abnormalSpecialRenderFlag\n                    ? tracks[level1].displays[0].height\n                    : 0;\n                const pf1 = hasPaired ? -1 : 1;\n                const y0 = heightFromSpecificLevel(views, trackId, level1, getTrackYPosOverride);\n                const path = [\n                    'M',\n                    x1,\n                    y1,\n                    'C',\n                    x1 + 200 * f1.get('strand') * rf1,\n                    abnormalSpecialRenderFlag\n                        ? Math.min(y0 - yOffset + trackHeight, y1 + trackHeight)\n                        : y1,\n                    x2 - 200 * f2.get('strand') * rf2 * pf1,\n                    abnormalSpecialRenderFlag\n                        ? Math.min(y0 - yOffset + trackHeight, y2 + trackHeight)\n                        : y2,\n                    x2,\n                    y2,\n                ].join(' ');\n                const id = `${f1.id()}-${f2.id()}`;\n                ret.push(_jsx(\"path\", { d: path, \"data-testid\": \"r1\", pointerEvents: interactiveOverlay ? 'auto' : undefined, strokeWidth: mouseoverElt === id ? 5 : 1, ...getStrokeProps(orientationColor || theme.palette.text.disabled), onClick: () => {\n                        var _a, _b;\n                        const featureWidget = (_a = session.addWidget) === null || _a === void 0 ? void 0 : _a.call(session, 'BreakpointAlignmentsWidget', 'breakpointAlignments', {\n                            featureData: {\n                                feature1: (allFeatures.get(f1.id()) || { toJSON: () => { } }).toJSON(),\n                                feature2: (allFeatures.get(f2.id()) || { toJSON: () => { } }).toJSON(),\n                            },\n                        });\n                        (_b = session.showWidget) === null || _b === void 0 ? void 0 : _b.call(session, featureWidget);\n                    }, onMouseOver: () => {\n                        setMouseoverElt(id);\n                    }, onMouseOut: () => {\n                        setMouseoverElt(undefined);\n                    } }, id));\n            }\n            return ret;\n        }) })) : null;\n});\nexport default AlignmentConnections;\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useMemo, useState } from 'react';\nimport { getSession } from '@jbrowse/core/util';\nimport { observer } from 'mobx-react';\nimport { getSnapshot } from 'mobx-state-tree';\nimport { findMatchingAlt, getMatchedBreakendFeatures } from './util';\nimport { getPxFromCoordinate, useNextFrame, yPos } from '../util';\nconst [LEFT] = [0, 1, 2, 3];\nconst Breakends = observer(function ({ model, trackId, parentRef: ref, getTrackYPosOverride, }) {\n    const { interactiveOverlay, views } = model;\n    const session = getSession(model);\n    const { assemblyManager } = session;\n    const totalFeatures = model.getTrackFeatures(trackId);\n    const layoutMatches = useMemo(() => model.getMatchedFeaturesInLayout(trackId, getMatchedBreakendFeatures(totalFeatures)), [totalFeatures, trackId, model]);\n    const [mouseoverElt, setMouseoverElt] = useState();\n    const snap = getSnapshot(model);\n    useNextFrame(snap);\n    const assembly = assemblyManager.get(views[0].assemblyNames[0]);\n    if (!assembly) {\n        return null;\n    }\n    let yoff = 0;\n    if (ref.current) {\n        const rect = ref.current.getBoundingClientRect();\n        yoff = rect.top;\n    }\n    return (_jsx(\"g\", { stroke: \"green\", strokeWidth: 5, fill: \"none\", \"data-testid\": layoutMatches.length ? `${trackId}-loaded` : trackId, children: layoutMatches.map(chunk => {\n            const ret = [];\n            for (let i = 0; i < chunk.length - 1; i += 1) {\n                const { layout: c1, feature: f1, level: level1 } = chunk[i];\n                const { layout: c2, feature: f2, level: level2 } = chunk[i + 1];\n                const id = f1.id();\n                const relevantAlt = findMatchingAlt(f1, f2);\n                if (!c1 || !c2) {\n                    return null;\n                }\n                const f1origref = f1.get('refName');\n                const f2origref = f2.get('refName');\n                const f1ref = assembly.getCanonicalRefName(f1origref);\n                const f2ref = assembly.getCanonicalRefName(f2origref);\n                if (!f1ref || !f2ref) {\n                    throw new Error(`unable to find ref for ${f1ref || f2ref}`);\n                }\n                const x1 = getPxFromCoordinate(views[level1], f1ref, c1[LEFT]);\n                const x2 = getPxFromCoordinate(views[level2], f2ref, c2[LEFT]);\n                const reversed1 = views[level1].pxToBp(x1).reversed;\n                const reversed2 = views[level2].pxToBp(x2).reversed;\n                const tracks = views.map(v => v.getTrack(trackId));\n                const y1 = yPos(trackId, level1, views, tracks, c1, getTrackYPosOverride) -\n                    yoff;\n                const y2 = yPos(trackId, level2, views, tracks, c2, getTrackYPosOverride) -\n                    yoff;\n                if (!relevantAlt) {\n                    console.warn('the relevant ALT allele was not found, cannot render');\n                }\n                else {\n                    const path = [\n                        'M',\n                        x1 -\n                            20 *\n                                (relevantAlt.Join === 'left' ? -1 : 1) *\n                                (reversed1 ? -1 : 1),\n                        y1,\n                        'L',\n                        x1,\n                        y1,\n                        'L',\n                        x2,\n                        y2,\n                        'L',\n                        x2 -\n                            20 *\n                                (relevantAlt.MateDirection === 'left' ? 1 : -1) *\n                                (reversed2 ? -1 : 1),\n                        y2,\n                    ].join(' ');\n                    ret.push(_jsx(\"path\", { d: path, \"data-testid\": \"r2\", pointerEvents: interactiveOverlay ? 'auto' : undefined, strokeWidth: id === mouseoverElt ? 10 : 5, onClick: () => {\n                            var _a, _b, _c;\n                            const featureWidget = (_a = session.addWidget) === null || _a === void 0 ? void 0 : _a.call(session, 'VariantFeatureWidget', 'variantFeature', {\n                                featureData: (_b = totalFeatures.get(id)) === null || _b === void 0 ? void 0 : _b.toJSON(),\n                            });\n                            (_c = session.showWidget) === null || _c === void 0 ? void 0 : _c.call(session, featureWidget);\n                        }, onMouseOver: () => {\n                            setMouseoverElt(id);\n                        }, onMouseOut: () => {\n                            setMouseoverElt(undefined);\n                        } }, JSON.stringify(path)));\n                }\n            }\n            return ret;\n        }) }));\n});\nexport default Breakends;\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useMemo, useState } from 'react';\nimport { getSession } from '@jbrowse/core/util';\nimport { observer } from 'mobx-react';\nimport { getSnapshot } from 'mobx-state-tree';\nimport { getMatchedPairedFeatures } from './util';\nimport { getPxFromCoordinate, useNextFrame, yPos } from '../util';\nconst [LEFT] = [0, 1, 2, 3];\nconst PairedFeatures = observer(function ({ model, trackId, parentRef: ref, getTrackYPosOverride, }) {\n    const { interactiveOverlay, views } = model;\n    const session = getSession(model);\n    const { assemblyManager } = session;\n    const totalFeatures = model.getTrackFeatures(trackId);\n    const layoutMatches = useMemo(() => model.getMatchedFeaturesInLayout(trackId, getMatchedPairedFeatures(totalFeatures)), [totalFeatures, trackId, model]);\n    const [mouseoverElt, setMouseoverElt] = useState();\n    const snap = getSnapshot(model);\n    useNextFrame(snap);\n    const assembly = assemblyManager.get(views[0].assemblyNames[0]);\n    if (!assembly) {\n        return null;\n    }\n    let yoff = 0;\n    if (ref.current) {\n        const rect = ref.current.getBoundingClientRect();\n        yoff = rect.top;\n    }\n    return (_jsx(\"g\", { stroke: \"green\", strokeWidth: 5, fill: \"none\", \"data-testid\": layoutMatches.length ? `${trackId}-loaded` : trackId, children: layoutMatches.map(chunk => {\n            const ret = [];\n            for (let i = 0; i < chunk.length - 1; i += 1) {\n                const { layout: c1, feature: f1, level: level1 } = chunk[i];\n                const { layout: c2, feature: f2, level: level2 } = chunk[i + 1];\n                const id = f1.id();\n                if (!c1 || !c2) {\n                    return null;\n                }\n                const f1origref = f1.get('refName');\n                const f2origref = f2.get('refName');\n                const f1ref = assembly.getCanonicalRefName(f1origref);\n                const f2ref = assembly.getCanonicalRefName(f2origref);\n                if (!f1ref || !f2ref) {\n                    throw new Error(`unable to find ref for ${f1ref || f2ref}`);\n                }\n                const x1 = getPxFromCoordinate(views[level1], f1ref, c1[LEFT]);\n                const x2 = getPxFromCoordinate(views[level2], f2ref, c2[LEFT]);\n                const tracks = views.map(v => v.getTrack(trackId));\n                const y1 = yPos(trackId, level1, views, tracks, c1, getTrackYPosOverride) -\n                    yoff;\n                const y2 = yPos(trackId, level2, views, tracks, c2, getTrackYPosOverride) -\n                    yoff;\n                const path = [\n                    'M',\n                    x1,\n                    y1,\n                    'L',\n                    x2,\n                    y2,\n                ].join(' ');\n                ret.push(_jsx(\"path\", { d: path, \"data-testid\": \"r2\", pointerEvents: interactiveOverlay ? 'auto' : undefined, strokeWidth: id === mouseoverElt ? 10 : 5, onClick: () => {\n                        var _a, _b, _c;\n                        const featureWidget = (_a = session.addWidget) === null || _a === void 0 ? void 0 : _a.call(session, 'VariantFeatureWidget', 'variantFeature', {\n                            featureData: (_b = totalFeatures.get(id)) === null || _b === void 0 ? void 0 : _b.toJSON(),\n                        });\n                        (_c = session.showWidget) === null || _c === void 0 ? void 0 : _c.call(session, featureWidget);\n                    }, onMouseOver: () => {\n                        setMouseoverElt(id);\n                    }, onMouseOut: () => {\n                        setMouseoverElt(undefined);\n                    } }, JSON.stringify(path)));\n            }\n            return ret;\n        }) }));\n});\nexport default PairedFeatures;\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useMemo, useState } from 'react';\nimport { getSession } from '@jbrowse/core/util';\nimport { observer } from 'mobx-react';\nimport { getSnapshot } from 'mobx-state-tree';\nimport { getMatchedTranslocationFeatures } from './util';\nimport { getPxFromCoordinate, useNextFrame, yPos } from '../util';\nconst [LEFT] = [0, 1, 2, 3];\nfunction str(s) {\n    if (s === '+') {\n        return 1;\n    }\n    else if (s === '-') {\n        return -1;\n    }\n    else {\n        return 0;\n    }\n}\nconst Translocations = observer(function ({ model, trackId, parentRef: ref, getTrackYPosOverride, }) {\n    const { interactiveOverlay, views } = model;\n    const session = getSession(model);\n    const { assemblyManager } = session;\n    const totalFeatures = model.getTrackFeatures(trackId);\n    const layoutMatches = useMemo(() => model.getMatchedFeaturesInLayout(trackId, getMatchedTranslocationFeatures(totalFeatures)), [totalFeatures, trackId, model]);\n    const [mouseoverElt, setMouseoverElt] = useState();\n    const snap = getSnapshot(model);\n    useNextFrame(snap);\n    const assembly = assemblyManager.get(views[0].assemblyNames[0]);\n    if (!assembly) {\n        return null;\n    }\n    let yOffset = 0;\n    if (ref.current) {\n        const rect = ref.current.getBoundingClientRect();\n        yOffset = rect.top;\n    }\n    if (views.length < 2) {\n        return null;\n    }\n    return (_jsx(\"g\", { fill: \"none\", stroke: \"green\", strokeWidth: 5, \"data-testid\": layoutMatches.length ? `${trackId}-loaded` : trackId, children: layoutMatches.map(chunk => {\n            var _a, _b;\n            const ret = [];\n            for (const { layout: c1, feature: f1, level: level1 } of chunk) {\n                const level2 = level1 === 0 ? 1 : 0;\n                const id = f1.id();\n                if (!c1) {\n                    return null;\n                }\n                const info = f1.get('INFO');\n                const chr2 = info.CHR2[0];\n                const end2 = info.END[0];\n                const res = (_b = (_a = info.STRANDS) === null || _a === void 0 ? void 0 : _a[0]) === null || _b === void 0 ? void 0 : _b.split('');\n                const [myDirection, mateDirection] = res !== null && res !== void 0 ? res : ['.', '.'];\n                const r = getPxFromCoordinate(views[level2], chr2, end2);\n                if (r) {\n                    const c2 = [r, 0, r + 1, 0];\n                    const x1 = getPxFromCoordinate(views[level1], f1.get('refName'), c1[LEFT]);\n                    const x2 = r;\n                    const reversed1 = views[level1].pxToBp(x1).reversed;\n                    const reversed2 = views[level2].pxToBp(x2).reversed;\n                    const tracks = views.map(v => v.getTrack(trackId));\n                    const y1 = yPos(trackId, level1, views, tracks, c1, getTrackYPosOverride) -\n                        yOffset;\n                    const y2 = yPos(trackId, level2, views, tracks, c2, getTrackYPosOverride) -\n                        yOffset;\n                    const path = [\n                        'M',\n                        x1 - 20 * str(myDirection) * (reversed1 ? -1 : 1),\n                        y1,\n                        'L',\n                        x1,\n                        y1,\n                        'L',\n                        x2,\n                        y2,\n                        'L',\n                        x2 - 20 * str(mateDirection) * (reversed2 ? -1 : 1),\n                        y2,\n                    ].join(' ');\n                    ret.push(_jsx(\"path\", { d: path, pointerEvents: interactiveOverlay ? 'auto' : undefined, strokeWidth: id === mouseoverElt ? 10 : 5, onClick: () => {\n                            var _a, _b;\n                            const featureWidget = (_a = session.addWidget) === null || _a === void 0 ? void 0 : _a.call(session, 'VariantFeatureWidget', 'variantFeature', {\n                                featureData: (totalFeatures.get(id) || { toJSON: () => { } }).toJSON(),\n                            });\n                            (_b = session.showWidget) === null || _b === void 0 ? void 0 : _b.call(session, featureWidget);\n                        }, onMouseOver: () => {\n                            setMouseoverElt(id);\n                        }, onMouseOut: () => {\n                            setMouseoverElt(undefined);\n                        } }, JSON.stringify(path)));\n                }\n            }\n            return ret;\n        }) }));\n});\nexport default Translocations;\n","import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { observer } from 'mobx-react';\nimport AlignmentConnections from './AlignmentConnections';\nimport Breakends from './Breakends';\nimport PairedFeatures from './PairedFeatures';\nimport Translocations from './Translocations';\nconst Overlay = observer(function (props) {\n    var _a;\n    const { model, trackId } = props;\n    const tracks = model.getMatchedTracks(trackId);\n    const type = (_a = tracks[0]) === null || _a === void 0 ? void 0 : _a.type;\n    if (type === 'AlignmentsTrack') {\n        return _jsx(AlignmentConnections, { ...props });\n    }\n    else if (type === 'VariantTrack') {\n        return model.hasTranslocations(trackId) ? (_jsx(Translocations, { ...props })) : model.hasPairedFeatures(trackId) ? (_jsx(PairedFeatures, { ...props })) : (_jsx(Breakends, { ...props }));\n    }\n    else {\n        return null;\n    }\n});\nexport default Overlay;\n"],"names":["getBadlyPairedAlignments","features","candidates","alreadySeen","alreadyPairedWithSamePosition","feature","flags","id","supp","assembleLocStringFast","unmapped","correctlyPaired","n","val","v","getMatchedAlignmentFeatures","_a","hasSA","hasPairedReads","f","findMatchingAlt","feat1","feat2","alts","alt","parseBreakend","notEmpty","bnd","getMatchedBreakendFeatures","feats","a","cur","getMatchedTranslocationFeatures","ret","getMatchedPairedFeatures","r1","r2","orientationTypes","pairMap","strokeColor","alpha","defaultColor","getPairedOrientationColorOrDefault","r","type2","getLongReadOrientationColorOrDefault","s1","s2","getLongReadOrientationAbnormal","isAbnormalOrientation","getPairedOrientationColor","LEFT","RIGHT","AlignmentConnections","observer","model","trackId","parentRef","getTrackYPosOverride","interactiveOverlay","views","showIntraviewLinks","theme","useTheme","session","getSession","snap","getSnapshot","assemblyManager","v0","assembly","useNextFrame","allFeatures","hasPaired","useMemo","layoutMatches","m","b","mouseoverElt","setMouseoverElt","useState","yOffset","_jsx","chunk","i","c1","f1","level1","c2","f2","level2","f1ref","f2ref","checkOrientation","orientationColor","isAbnormal","p1","sn1","p2","x1","getPxFromCoordinate","x2","reversed1","reversed2","rf1","rf2","tracks","y1","yPos","y2","abnormalSpecialRenderFlag","trackHeight","pf1","y0","heightFromSpecificLevel","path","getStrokeProps","_b","featureWidget","Breakends","ref","totalFeatures","yoff","relevantAlt","f1origref","f2origref","_c","PairedFeatures","str","s","Translocations","info","chr2","end2","res","myDirection","mateDirection","Overlay","props","type"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6]}