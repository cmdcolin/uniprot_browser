import{o as S,m as w,a,u as x,h as U,j as s,c as f,D as L,aL as R,T as C,d as D,e as E,B,aP as I,aQ as T}from"./index-DPMJgfAS.js";import{s as v}from"./sessionSharing-DTJt6fso.js";import{D as g}from"./DialogContentText-VobH5f7f.js";import"./GridBookmarkWidget-DrjMH57G.js";import"./MenuItem-BZgCoK98.js";import"./dividerClasses-CRpWzjDJ.js";import"./DataGrid-BbeQwLC2.js";import"./index-BHGTJiUw.js";import"./utils-DSyQ0Yxy.js";import"./getThemeProps-D2Hd2SEb.js";import"./Divider-BsNHrm83.js";import"./Badge-HDwRQZRU.js";import"./TableCell-CTZZHzq1.js";import"./ColorPicker-DOkiVKNe.js";import"./DataGridFlexContainer-B8arD5BB.js";const A=w()(()=>({flexItem:{margin:5},content:{display:"flex",flexFlow:"column",gap:"5px"}})),X=S(function({onClose:l,model:r}){const{classes:c}=A(),[h,y]=a.useState(""),[d,j]=a.useState(),[m,n]=a.useState(!0),t=x.getSession(r),{selectedBookmarks:p}=r,b=p.length===0,k=p.length===0?r.allBookmarksModel:r.sharedBookmarksModel;return a.useEffect(()=>{(async()=>{try{if(!x.isSessionWithShareURL(t))throw new Error("No shareURL configured");n(!0);const e=U(k),o=new URL(window.location.href),u=await v(e,t.shareURL,o.href),i=new URLSearchParams(o.search);i.set("bookmarks",`share-${u.json.sessionId}`),i.set("password",u.password),o.search=i.toString(),y(o.href),n(!1)}catch(e){j(e)}finally{n(!1)}})()},[k,t]),s.jsxs(f.Dialog,{open:!0,onClose:l,title:"Share bookmarks",children:[s.jsxs(L,{className:c.content,children:[s.jsx(R,{severity:"info",children:b?s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"All bookmarks will be shared."}),s.jsx("br",{}),s.jsx("span",{children:"Use the checkboxes to select individual bookmarks to share."})]}):"Only selected bookmarks will be shared."}),s.jsx(g,{children:"Copy the URL below to share your bookmarks."}),d?s.jsx(f.ErrorMessage,{error:d}):m?s.jsx(C,{children:"Generating short URL..."}):s.jsx(D,{label:"URL",value:h,slotProps:{input:{readOnly:!0}},variant:"filled",fullWidth:!0,onClick:e=>{e.target.select()}}),s.jsx(g,{children:'The URL should be pasted into the "Import from share link" field in the "Import" form found in the "Bookmarked regions" drawer.'})]}),s.jsx(E,{children:s.jsx(B,{className:c.flexItem,"data-testid":"dialogShare",variant:"contained",color:"primary",disabled:m,startIcon:s.jsx(T,{}),onClick:async()=>{I(h),t.notify("Copied to clipboard","success"),l()},children:"Copy share link"})})]})});export{X as default};
//# sourceMappingURL=ShareBookmarksDialog-BxJ-5drl.js.map
