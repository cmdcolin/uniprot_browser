{"version":3,"file":"getMultiVariantFeaturesAutorun-DiULzS9t.js","sources":["../../node_modules/@jbrowse/plugin-variants/esm/getMultiVariantFeaturesAutorun.js"],"sourcesContent":["import { SimpleFeature, getContainingView, getSession, } from '@jbrowse/core/util';\nimport { isAbortException } from '@jbrowse/core/util/aborting';\nimport { createStopToken } from '@jbrowse/core/util/stopToken';\nimport { getRpcSessionId } from '@jbrowse/core/util/tracks';\nimport { autorun } from 'mobx';\nimport { addDisposer, isAlive } from 'mobx-state-tree';\nexport function getMultiVariantFeaturesAutorun(self) {\n    addDisposer(self, autorun(async () => {\n        try {\n            const view = getContainingView(self);\n            if (!view.initialized || !self.statsReadyAndRegionNotTooLarge) {\n                return;\n            }\n            const stopToken = createStopToken();\n            self.setSimplifiedFeaturesLoading(stopToken);\n            const { rpcManager } = getSession(self);\n            const { lengthCutoffFilter, sources, minorAlleleFrequencyFilter, adapterConfig, } = self;\n            if (sources) {\n                const sessionId = getRpcSessionId(self);\n                const { sampleInfo, hasPhased, features } = (await rpcManager.call(sessionId, 'MultiVariantGetSimplifiedFeatures', {\n                    regions: view.dynamicBlocks.contentBlocks,\n                    sources,\n                    minorAlleleFrequencyFilter,\n                    lengthCutoffFilter,\n                    sessionId,\n                    adapterConfig,\n                    stopToken,\n                }));\n                if (isAlive(self)) {\n                    self.setHasPhased(hasPhased);\n                    self.setSampleInfo(sampleInfo);\n                    self.setFeatures(features.map(f => new SimpleFeature(f)));\n                }\n            }\n        }\n        catch (e) {\n            console.error(e);\n            if (!isAbortException(e) && isAlive(self)) {\n                getSession(self).notifyError(`${e}`, e);\n            }\n        }\n    }, {\n        delay: 1000,\n    }));\n}\n"],"names":["getMultiVariantFeaturesAutorun","self","addDisposer","autorun","view","getContainingView","stopToken","createStopToken","rpcManager","getSession","lengthCutoffFilter","sources","minorAlleleFrequencyFilter","adapterConfig","sessionId","getRpcSessionId","sampleInfo","hasPhased","features","isAlive","f","SimpleFeature","isAbortException"],"mappings":"sHAMO,SAASA,EAA+BC,EAAM,CACjDC,EAAYD,EAAME,EAAQ,SAAY,CAClC,GAAI,CACA,MAAMC,EAAOC,EAAAA,kBAAkBJ,CAAI,EACnC,GAAI,CAACG,EAAK,aAAe,CAACH,EAAK,+BAC3B,OAEJ,MAAMK,EAAYC,EAAAA,gBAAe,EACjCN,EAAK,6BAA6BK,CAAS,EAC3C,KAAM,CAAE,WAAAE,CAAU,EAAKC,EAAAA,WAAWR,CAAI,EAChC,CAAE,mBAAAS,EAAoB,QAAAC,EAAS,2BAAAC,EAA4B,cAAAC,CAAa,EAAMZ,EACpF,GAAIU,EAAS,CACT,MAAMG,EAAYC,EAAAA,gBAAgBd,CAAI,EAChC,CAAE,WAAAe,EAAY,UAAAC,EAAW,SAAAC,CAAQ,EAAM,MAAMV,EAAW,KAAKM,EAAW,oCAAqC,CAC/G,QAASV,EAAK,cAAc,cAC5B,QAAAO,EACA,2BAAAC,EACA,mBAAAF,EACA,UAAAI,EACA,cAAAD,EACA,UAAAP,CACpB,CAAiB,EACGa,EAAQlB,CAAI,IACZA,EAAK,aAAagB,CAAS,EAC3BhB,EAAK,cAAce,CAAU,EAC7Bf,EAAK,YAAYiB,EAAS,IAAIE,GAAK,IAAIC,EAAAA,cAAcD,CAAC,CAAC,CAAC,EAEhE,CACJ,OACO,EAAG,CACN,QAAQ,MAAM,CAAC,EACX,CAACE,EAAAA,iBAAiB,CAAC,GAAKH,EAAQlB,CAAI,GACpCQ,EAAAA,WAAWR,CAAI,EAAE,YAAY,GAAG,CAAC,GAAI,CAAC,CAE9C,CACJ,EAAG,CACC,MAAO,GACf,CAAK,CAAC,CACN","x_google_ignoreList":[0]}