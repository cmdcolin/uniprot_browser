{"version":3,"file":"SVGLinearGenomeView-CAzziqn3.js","sources":["../../node_modules/@jbrowse/plugin-linear-genome-view/esm/LinearGenomeView/svgcomponents/SVGBackground.js","../../node_modules/@jbrowse/plugin-linear-genome-view/esm/LinearGenomeView/svgcomponents/SVGScalebar.js","../../node_modules/@jbrowse/plugin-linear-genome-view/esm/LinearGenomeView/svgcomponents/SVGHeader.js","../../node_modules/@jbrowse/plugin-linear-genome-view/esm/LinearGenomeView/svgcomponents/SVGLinearGenomeView.js"],"sourcesContent":["import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { stripAlpha } from '@jbrowse/core/util';\nimport { useTheme } from '@mui/material';\nexport default function SVGBackground({ width, height, shift, }) {\n    const theme = useTheme();\n    return (_jsx(\"rect\", { width: width + shift * 2, height: height, fill: stripAlpha(theme.palette.background.default) }));\n}\n","import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { getBpDisplayStr, stripAlpha } from '@jbrowse/core/util';\nimport { useTheme } from '@mui/material';\nexport default function SVGScalebar({ model, fontSize, }) {\n    const { offsetPx, dynamicBlocks: { totalWidthPxWithoutBorders: totalWidthPx, totalBp }, } = model;\n    const theme = useTheme();\n    const displayBp = getBpDisplayStr(totalBp);\n    const x0 = Math.max(-offsetPx, 0);\n    const x1 = x0 + totalWidthPx;\n    const c = stripAlpha(theme.palette.text.secondary);\n    const x = x0 + (x1 - x0) / 2;\n    const y = fontSize;\n    return (_jsxs(_Fragment, { children: [_jsx(\"line\", { x1: x0, x2: x1, y1: 10, y2: 10, stroke: c }), _jsx(\"line\", { x1: x0, x2: x0, y1: 5, y2: 15, stroke: c }), _jsx(\"line\", { x1: x1, x2: x1, y1: 5, y2: 15, stroke: c }), _jsx(\"text\", { x: x, y: y, textAnchor: \"middle\", dominantBaseline: \"hanging\", fontSize: fontSize, fill: c, children: displayBp })] }));\n}\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { getSession, stripAlpha } from '@jbrowse/core/util';\nimport Base1DView from '@jbrowse/core/util/Base1DViewModel';\nimport { useTheme } from '@mui/material';\nimport SVGRuler from './SVGRuler';\nimport SVGScalebar from './SVGScalebar';\nimport Cytobands from '../components/Cytobands';\nimport OverviewScalebarPolygon from '../components/OverviewScalebarPolygon';\nimport { HEADER_OVERVIEW_HEIGHT } from '../consts';\nexport default function SVGHeader({ model, fontSize, cytobandHeight, rulerHeight, }) {\n    const { width, assemblyNames, showCytobands, displayedRegions } = model;\n    const { assemblyManager } = getSession(model);\n    const assemblyName = assemblyNames.length > 1 ? '' : assemblyNames[0];\n    const assembly = assemblyManager.get(assemblyName);\n    const theme = useTheme();\n    const c = stripAlpha(theme.palette.text.primary);\n    const overview = Base1DView.create({\n        displayedRegions: JSON.parse(JSON.stringify(displayedRegions)),\n        interRegionPaddingWidth: 0,\n        minimumBlockWidth: model.minimumBlockWidth,\n    });\n    const visibleRegions = model.dynamicBlocks.contentBlocks;\n    if (!visibleRegions.length) {\n        return null;\n    }\n    overview.setVolatileWidth(width);\n    overview.showAllRegions();\n    const block = overview.dynamicBlocks.contentBlocks[0];\n    const first = visibleRegions.at(0);\n    const last = visibleRegions.at(-1);\n    const firstOverviewPx = overview.bpToPx({\n        ...first,\n        coord: first.reversed ? first.end : first.start,\n    }) || 0;\n    const lastOverviewPx = overview.bpToPx({\n        ...last,\n        coord: last.reversed ? last.start : last.end,\n    }) || 0;\n    const y = +showCytobands * cytobandHeight;\n    return (_jsxs(\"g\", { id: \"header\", children: [_jsx(\"text\", { x: 0, y: 0, dominantBaseline: \"hanging\", fontSize: fontSize, fill: c, children: assemblyName }), showCytobands ? (_jsxs(\"g\", { transform: `translate(0 ${rulerHeight})`, children: [_jsx(Cytobands, { overview: overview, assembly: assembly, block: block }), _jsx(\"rect\", { stroke: \"red\", fill: \"rgb(255,0,0)\", fillOpacity: 0.1, width: Math.max(lastOverviewPx - firstOverviewPx, 0.5), height: HEADER_OVERVIEW_HEIGHT - 1, x: firstOverviewPx, y: 0.5 }), _jsx(\"g\", { transform: `translate(0,${HEADER_OVERVIEW_HEIGHT})`, children: _jsx(OverviewScalebarPolygon, { overview: overview, model: model, useOffset: false }) })] })) : null, _jsx(\"g\", { transform: `translate(0 ${fontSize + y})`, children: _jsx(SVGScalebar, { model: model, fontSize: fontSize }) }), _jsx(\"g\", { transform: `translate(0 ${rulerHeight + y})`, children: _jsx(SVGRuler, { model: model, fontSize: fontSize }) })] }));\n}\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { createJBrowseTheme } from '@jbrowse/core/ui';\nimport { getSession, max, measureText, renderToStaticMarkup, } from '@jbrowse/core/util';\nimport { getTrackName } from '@jbrowse/core/util/tracks';\nimport { ThemeProvider } from '@mui/material';\nimport { when } from 'mobx';\nimport SVGBackground from './SVGBackground';\nimport SVGHeader from './SVGHeader';\nimport SVGTracks from './SVGTracks';\nimport { totalHeight } from './util';\nexport async function renderToSvg(model, opts) {\n    await when(() => model.initialized);\n    const { textHeight = 18, headerHeight = 40, rulerHeight = 50, fontSize = 13, cytobandHeight = 100, trackLabels = 'offset', themeName = 'default', Wrapper = ({ children }) => children, } = opts;\n    const session = getSession(model);\n    const { allThemes } = session;\n    const theme = allThemes === null || allThemes === void 0 ? void 0 : allThemes()[themeName];\n    const { width, pinnedTracks, unpinnedTracks, tracks, showCytobands } = model;\n    const shift = 50;\n    const c = +showCytobands * cytobandHeight;\n    const offset = headerHeight + rulerHeight + c + 10;\n    const height = totalHeight(tracks, textHeight, trackLabels) + offset + 100;\n    const displayResults = await Promise.all([...pinnedTracks, ...unpinnedTracks].map(async (track) => {\n        const display = track.displays[0];\n        await when(() => !display.renderProps().notReady);\n        return { track, result: await display.renderSvg({ ...opts, theme }) };\n    }));\n    const trackLabelMaxLen = max(tracks.map(t => measureText(getTrackName(t.configuration, session), fontSize)), 0) + 40;\n    const trackLabelOffset = trackLabels === 'left' ? trackLabelMaxLen : 0;\n    const w = width + trackLabelOffset;\n    return renderToStaticMarkup(_jsx(ThemeProvider, { theme: createJBrowseTheme(theme), children: _jsx(Wrapper, { children: _jsxs(\"svg\", { width: w, height: height, xmlns: \"http://www.w3.org/2000/svg\", xmlnsXlink: \"http://www.w3.org/1999/xlink\", viewBox: [0, 0, w + shift * 2, height].toString(), children: [_jsx(SVGBackground, { width: w, height: height, shift: shift }), _jsxs(\"g\", { transform: `translate(${shift} 0)`, children: [_jsx(\"g\", { transform: `translate(${trackLabelOffset})`, children: _jsx(SVGHeader, { model: model, fontSize: fontSize, rulerHeight: rulerHeight, cytobandHeight: cytobandHeight }) }), _jsx(\"g\", { transform: `translate(0 ${offset})`, children: _jsx(SVGTracks, { textHeight: textHeight, fontSize: fontSize, model: model, displayResults: displayResults, trackLabels: trackLabels, trackLabelOffset: trackLabelOffset }) })] })] }) }) }));\n}\nexport { default as SVGRuler } from './SVGRuler';\nexport { default as SVGTracks } from './SVGTracks';\n"],"names":["SVGBackground","width","height","shift","theme","useTheme","_jsx","stripAlpha","SVGScalebar","model","fontSize","offsetPx","totalWidthPx","totalBp","displayBp","getBpDisplayStr","x0","x1","c","x","y","_jsxs","_Fragment","SVGHeader","cytobandHeight","rulerHeight","assemblyNames","showCytobands","displayedRegions","assemblyManager","getSession","assemblyName","assembly","overview","Base1DView","visibleRegions","block","first","last","firstOverviewPx","lastOverviewPx","Cytobands","HEADER_OVERVIEW_HEIGHT","OverviewScalebarPolygon","SVGRuler","renderToSvg","opts","when","textHeight","headerHeight","trackLabels","themeName","Wrapper","children","session","allThemes","pinnedTracks","unpinnedTracks","tracks","offset","totalHeight","displayResults","track","display","trackLabelMaxLen","max","t","measureText","getTrackName","trackLabelOffset","w","renderToStaticMarkup","ThemeProvider","createJBrowseTheme","SVGTracks"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}