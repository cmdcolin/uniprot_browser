const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-B3kPj2Rj.js","./index-DzaTm5oQ.css"])))=>i.map(i=>d[i]);
import{u,c4 as _,x as E,c5 as $,a as y,j as n,T as x,c as b,L as h,_ as v,c6 as k}from"./index-B3kPj2Rj.js";import{B as A}from"./BaseCard-D1jVHuu1.js";import{n as R}from"./AlignmentsFeatureDetail-waO_C66b.js";import"./FeatureDetails-C7VLYp0Q.js";async function B({view:e,feature:s}){var a;const{assemblyManager:i}=u.getSession(e),r=s.get("CIGAR"),l=s.get("strand"),d=((a=s.get("tags"))===null||a===void 0?void 0:a.SA)||"",m=s.get("name"),t=_(r,1),g=await i.waitForAssembly(e.assemblyNames[0]);if(!g)throw new Error("assembly not found");const p=E(d,s.id(),l,m,!0),o=s.toJSON();o.clipPos=t,o.strand=1,o.mate={refName:m,start:t,end:t+$(r)};const S=[o,...p];for(const[f,c]of S.entries())c.refName=g.getCanonicalRefName(c.refName)||c.refName,c.syntenyId=f,c.mate.syntenyId=f,c.mate.uniqueId=`${c.uniqueId}_mate`;return S.sort((f,c)=>f.clipPos-c.clipPos),S}const C=y.lazy(()=>v(()=>import("./index-B3kPj2Rj.js").then(e=>e.dK),__vite__mapDeps([0,1]),import.meta.url)),D=y.lazy(()=>v(()=>import("./index-B3kPj2Rj.js").then(e=>e.dL),__vite__mapDeps([0,1]),import.meta.url));function P({model:e,feature:s}){const{view:a}=e,[i,r]=y.useState(),[l,d]=y.useState();y.useEffect(()=>{(async()=>{try{const t=await B({view:a,feature:new u.SimpleFeature(s)});r(t)}catch(t){d(t),console.error(t)}})()},[s,a]);const m=[];if(i)for(let t=0;t<i.length-1;t++)m.push([i[t],i[t+1]]);return m.length?n.jsxs("div",{children:[n.jsx(x,{children:"Launch split view"}),l?n.jsx(b.ErrorMessage,{error:l}):null,n.jsx("ul",{children:m.map((t,g)=>{const[p,o]=t;return n.jsxs("li",{children:[p.refName,":",u.toLocale(p.strand===1?p.end:p.start)," ->"," ",o.refName,":",u.toLocale(o.strand===1?o.start:o.end)," ",n.jsx(V,{model:e,f1:p,f2:o})," ",n.jsx(I,{model:e,f1:p,f2:o})]},`${JSON.stringify(t)}-${g}`)})})]}):null}function V({model:e,f1:s,f2:a}){return n.jsx(h,{href:"#",onClick:i=>{i.preventDefault();const r=u.getSession(e);r.queueDialog(l=>[C,{handleClose:l,session:r,feature:new u.SimpleFeature({...s,mate:a}),view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])},children:"(top/bottom)"})}function I({model:e,f1:s,f2:a}){return n.jsx(h,{href:"#",onClick:i=>{i.preventDefault();const r=u.getSession(e);r.queueDialog(l=>[D,{handleClose:l,session:r,feature:new u.SimpleFeature({...s,mate:a}),view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])},children:"(single row)"})}function O({tag:e,model:s}){return n.jsxs("div",{children:[n.jsx(x,{children:"List of supplementary alignment locations"}),n.jsx("ul",{children:e.split(";").filter(a=>!!a).map((a,i)=>{const[r,l,d,m]=a.split(","),t=k(m),g=Math.floor(t/5),p=+l,o=+l+t,S=p-g,f=o+g,c=`${r}:${Math.max(1,S)}-${f}`,w=p.toLocaleString("en-US"),L=o.toLocaleString("en-US"),j=`${r}:${w}-${L} (${d}) [${t}bp]`;return n.jsx("li",{children:n.jsx(h,{href:"#",onClick:async N=>{N.preventDefault(),R(c,s)},children:j})},`${c}-${i}`)})})]})}function z(e){const{model:s,tag:a,feature:i}=e,r=u.getSession(s),{pluginManager:l}=u.getEnv(r);let d=!1;try{d=!!l.getViewType("BreakpointSplitView")}catch{}return n.jsxs(A,{...e,title:"Supplementary alignments",children:[n.jsx(O,{model:s,tag:a}),d?n.jsx(P,{model:s,feature:i}):null]})}export{z as default};
//# sourceMappingURL=SupplementaryAlignments-8bHiRbV8.js.map
