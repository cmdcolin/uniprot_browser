import{a5 as X,m as T,a as C,j as i,c as B,D as H,f as j,C as k,d as O,e as P,B as v}from"./index-DPMJgfAS.js";const{parseCigar:U}=X;function E(t,n){let s=0,c=0;for(let a=0;a<t.length;a++){const d=+t[a],o=t[a+1],r=Math.min(d,n-s);if(s>=n)break;o==="I"?c+=d:o==="D"?s+=r:(o==="M"||o==="="||o==="X")&&(c+=r,s+=r)}return[s,c]}async function q({feature:t,windowSize:n,session:s,trackId:c,region:a,horizontallyFlip:d}){const o=t.get("CIGAR"),r=t.get("strand"),g=t.get("refName"),p=t.get("assemblyName"),l=t.get("start"),u=t.get("end"),m=t.get("mate"),y=m.start,e=m.end,M=m.assemblyName,L=m.refName;let h,f,S,x;if(a&&o){const D=a.start,I=a.end,b=U(o),[N,F]=E(b,D-l),[G,V]=E(b,I-l),w=r===-1?-1:1;S=l+N,x=l+G,h=(r===-1?e:y)+F*w,f=(r===-1?e:y)+V*w}else S=l,x=u,h=y,f=e;const R=`${g}:${Math.floor(S-n)}-${Math.floor(x+n)}`,$=Math.min(h,f),z=Math.max(h,f),A=`${L}:${Math.floor($-n)}-${Math.floor(z+n)}${d?"[rev]":""}`;s.addView("LinearSyntenyView",{type:"LinearSyntenyView",views:[{type:"LinearGenomeView",hideHeader:!0,init:{assembly:p,loc:R}},{type:"LinearGenomeView",hideHeader:!0,init:{assembly:M,loc:A}}],tracks:[{configuration:c,type:"SyntenyTrack",displays:[{type:"LinearSyntenyDisplay",configuration:`${c}-LinearSyntenyDisplay`}]}]})}const W=T()({padding:{margin:10,border:"1px solid #ccc"}});function K({session:t,view:n,feature:s,trackId:c,handleClose:a}){const{classes:d}=W(),o=s.get("strand")===-1,r=!!s.get("CIGAR"),[g,p]=C.useState(o),[l,u]=C.useState("1000"),[m,y]=C.useState(!0);return i.jsxs(B.Dialog,{open:!0,title:"Launch synteny view",onClose:a,children:[i.jsxs(H,{children:[n&&r?i.jsx(j,{className:d.padding,control:i.jsx(k,{checked:m,onChange:e=>{y(e.target.checked)}}),label:"Use CIGAR string to navigate the current visible to the target"}):null,o?i.jsx(j,{className:d.padding,control:i.jsx(k,{checked:g,onChange:e=>{p(e.target.checked)}}),label:`Note: The feature is inverted in orientation on the target
            sequence. This will result in the lower panel having genomic
            coordinates decreasing left to right. Horizontally flip?`}):null,i.jsx(O,{label:"Add window size in bp",value:l,onChange:e=>{u(e.target.value)}})]}),i.jsxs(P,{children:[i.jsx(v,{variant:"contained",onClick:()=>{(async()=>{try{await q({feature:s,windowSize:+l,horizontallyFlip:g,trackId:c,session:t,region:m?n?.dynamicBlocks.contentBlocks[0]:void 0})}catch(e){console.error(e),t.notifyError(`${e}`,e)}})(),a()},children:"Submit"}),i.jsx(v,{variant:"contained",color:"secondary",onClick:()=>{a()},children:"Cancel"})]})]})}export{K as default};
//# sourceMappingURL=LaunchSyntenyViewDialog-BgNINmwx.js.map
