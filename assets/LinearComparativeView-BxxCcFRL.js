import{o as x,m as g,j as e,cO as J,T as F,u as v,a as p,F as Y,ci as R,ap as Q,co as U,cP as q,c as H,y as K,am as z,Q as W,cA as P}from"./index-B3kPj2Rj.js";const Z=g()(()=>({bp:{display:"flex",alignItems:"center",marginLeft:10},searchBox:{display:"flex"}})),ee=x(function({view:n}){const{classes:s}=Z(),{assemblyDisplayNames:t,coarseTotalBp:o}=n;return e.jsxs("span",{className:s.searchBox,children:[e.jsx(J,{model:n,showHelp:!1}),e.jsxs(F,{variant:"body2",color:"textSecondary",className:s.bp,children:[t.join(",")," ",v.getBpDisplayStr(o)]})]})}),ne=g()({inline:{display:"inline-flex"}}),te=x(function({model:n}){const{classes:s}=ne(),{views:t}=n,[o,c]=p.useState(t.length<=3),[r,l]=p.useState(t.length<=3);return e.jsxs(Y,{row:!0,children:[e.jsx(R,{menuItems:[{label:"Synteny track selectors",type:"subMenu",subMenu:t.slice(0,-1).map((i,a)=>({label:`Row ${a+1}->${a+2} (${t[a].assemblyNames.join(",")}->${t[a+1].assemblyNames.join(",")})`,onClick:()=>{n.activateTrackSelector(a)}}))},{label:"Row track selectors",type:"subMenu",subMenu:t.map((i,a)=>({label:`Row ${a+1} track selector (${i.assemblyNames.join(",")})`,onClick:()=>i.activateTrackSelector()}))}],children:e.jsx(Q.TrackSelector,{})}),e.jsx(R,{menuItems:[{label:"Row view menus",type:"subMenu",subMenu:t.map((i,a)=>({label:`View ${a+1} Menu`,subMenu:i.menuItems()}))},...n.headerMenuItems()],children:e.jsx(U,{})}),e.jsx(R,{menuItems:[{label:"Show search boxes",type:"checkbox",checked:o,onClick:()=>{c(!o)}},{label:"Orientation - Side-by-side",type:"radio",checked:r,onClick:()=>{l(!r)}},{label:"Orientation - Vertical",type:"radio",checked:!r,onClick:()=>{l(!r)}}],children:e.jsx(q,{})}),o?e.jsx("span",{className:r?s.inline:void 0,children:t.map(i=>e.jsx(ee,{view:i},i.id))}):null]})}),L=g()({container:{display:"grid"},overlay:{zIndex:100,gridArea:"1/1"},resizeHandle:{height:4,background:"#ccc"}});function se({view:n}){const{pluginManager:s}=v.getEnv(n),{ReactComponent:t}=s.getViewType(n.type);return e.jsx(t,{model:n})}const oe=x(function({model:n}){const{classes:s}=L(),{views:t,levels:o}=n;return e.jsx("div",{className:s.container,children:t.map((c,r)=>e.jsxs(e.Fragment,{children:[r>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:s.container,children:e.jsx(re,{model:n,level:r-1})}),e.jsx(H.ResizeHandle,{onDrag:l=>{var i,a;return(i=o[r-1])===null||i===void 0?void 0:i.setHeight((((a=o[r-1])===null||a===void 0?void 0:a.height)||0)+l)},className:s.resizeHandle})]}):null,e.jsx(se,{view:c})]},c.id))})}),re=x(function({model:n,level:s}){var t;const{classes:o}=L();return e.jsx(e.Fragment,{children:(t=n.levels[s])===null||t===void 0?void 0:t.tracks.map(c=>{const[r]=c.displays,{RenderingComponent:l}=r,i=K.getConf(c,"trackId");return l?e.jsx("div",{className:o.overlay,style:{height:r.height,overflow:"hidden"},children:e.jsx(l,{model:r})},i):null})})});function D({anchorEl:n,side:s,text:t}){return e.jsx(z,{title:t,open:!0,placement:s==="left"?"left-start":"right-start",slotProps:{popper:{anchorEl:n,modifiers:[{name:"offset",options:{offset:[-30,-10]}}]}},children:e.jsx("span",{})})}const ie=g()(n=>{const{tertiary:s}=n.palette;return{rubberband:{height:"100%",background:W(s.light,.7),position:"absolute",zIndex:830,textAlign:"center"},rubberbandText:{color:n.palette.tertiary.contrastText}}});function ae({leftBpOffset:n,rightBpOffset:s,numOfBpSelected:t,left:o,width:c,top:r=0,sticky:l=!1}){const{classes:i}=ie(),[a,h]=p.useState(null);return e.jsxs(e.Fragment,{children:[a?e.jsxs(e.Fragment,{children:[e.jsx(D,{side:"left",anchorEl:a,text:n.map((d,f)=>e.jsx("div",{children:v.stringify(d,!0)},`JSON.stringify(l)-${f}`))}),e.jsx(D,{side:"right",anchorEl:a,text:s.map((d,f)=>e.jsx("div",{children:v.stringify(d,!0)},`JSON.stringify(l)-${f}`))})]}):null,e.jsx("div",{className:i.rubberband,style:{left:o,width:c},children:t?e.jsx(F,{ref:d=>{h(d)},variant:"h6",className:i.rubberbandText,style:{top:r,position:l?"sticky":void 0},children:t.map((d,f)=>e.jsx("div",{children:v.getBpDisplayStr(d)},f))}):null})]})}const ce=g()({guide:{pointerEvents:"none",height:"100%",width:1,position:"absolute",background:"red",zIndex:1001}}),le=x(function({model:n,coordX:s}){const{classes:t}=ce();return e.jsx(z,{open:!0,placement:"top",title:n.views.map(o=>o.pxToBp(s)).map((o,c)=>e.jsx("div",{children:v.stringify(o,!0)},[JSON.stringify(o),c].join("-"))),arrow:!0,children:e.jsx("div",{className:t.guide,style:{left:s}})})});function C(n,s){return n.clientX-(s?.getBoundingClientRect().left||0)}function ue(n,s){const[t,o]=p.useState(),[c,r]=p.useState(),[l,i]=p.useState(),[a,h]=p.useState(),d=t!==void 0&&l===void 0;p.useEffect(()=>{function u(m){if(t===void 0)return;const y=Math.min(t,m),E=Math.max(t,m);return s.views.map(S=>({leftOffset:S.pxToBp(y),rightOffset:S.pxToBp(E)}))}function b(m){if(n.current&&d){const y=C(m,n.current);r(y)}}function T(m){if(t!==void 0&&n.current){const{clientX:y,clientY:E}=m,S=C(m,n.current);i({offsetX:S,clientX:y,clientY:E});const $=u(S);$&&P(()=>{for(const[G,X]of $.entries())s.views[G].setOffsets(X.leftOffset,X.rightOffset)}),h(void 0)}}return d?(window.addEventListener("mousemove",b),window.addEventListener("mouseup",T),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",T)}):()=>{}},[t,d,s,n]),p.useEffect(()=>{!d&&c!==void 0&&t!==void 0&&Math.abs(c-t)<=3&&j()},[d,c,t]);function f(u){u.preventDefault(),u.stopPropagation();const b=C(u,n.current);o(b),r(b)}function w(u){h(C(u,n.current))}function M(){h(void 0),P(()=>{for(const u of s.views)u.setOffsets(void 0,void 0)})}function j(){i(void 0),o(void 0),r(void 0)}function k(u,b){b(),j()}const B=!!l;if(t===void 0)return{open:B,guideX:a,mouseDown:f,mouseMove:w,mouseOut:M,handleMenuItemClick:k};const O=l?l.offsetX:c||0,N=Math.min(O,t),I=Math.abs(O-t),V=s.views.map(u=>u.pxToBp(N)),A=s.views.map(u=>u.pxToBp(N+I)),_=s.views.map(u=>Math.ceil(I*u.bpPerPx));return{open:B,rubberbandOn:!0,mouseDown:f,mouseMove:w,mouseOut:M,handleClose:j,handleMenuItemClick:k,leftBpOffset:V,rightBpOffset:A,anchorPosition:l,numOfBpSelected:_,width:I,left:N}}const de=g()({rubberbandControl:{cursor:"crosshair",width:"100%",minHeight:8,position:"relative",zIndex:900}}),fe=x(function({model:n,ControlComponent:s=e.jsx("div",{})}){const t=p.useRef(null),{classes:o}=de(),{guideX:c,rubberbandOn:r,leftBpOffset:l,rightBpOffset:i,numOfBpSelected:a,width:h,left:d,anchorPosition:f,open:w,handleMenuItemClick:M,handleClose:j,mouseMove:k,mouseDown:B,mouseOut:O}=ue(t,n);return e.jsxs(e.Fragment,{children:[c!==void 0?e.jsx(le,{model:n,coordX:c}):r?e.jsx(ae,{leftBpOffset:l,rightBpOffset:i,numOfBpSelected:a,width:h,left:d}):null,f?e.jsx(H.Menu,{anchorReference:"anchorPosition",anchorPosition:{left:f.clientX,top:f.clientY},onMenuItemClick:M,open:w,onClose:j,menuItems:n.rubberBandMenuItems()}):null,e.jsx("div",{"data-testid":"rubberband_controls",className:o.rubberbandControl,ref:t,onMouseDown:B,onMouseMove:k,onMouseOut:O,children:s})]})}),pe=g()(n=>({rubberbandContainer:{position:"relative",overflow:"hidden"},rubberbandDiv:{width:"100%",background:n.palette.action.disabledBackground,height:15,"&:hover":{background:n.palette.action.selected}}})),be=x(function({model:n}){const{classes:s}=pe();return e.jsxs("div",{className:s.rubberbandContainer,children:[e.jsx(te,{model:n}),e.jsx(fe,{model:n,ControlComponent:e.jsx("div",{className:s.rubberbandDiv})}),e.jsx(oe,{model:n})]})});export{be as default};
//# sourceMappingURL=LinearComparativeView-BxxCcFRL.js.map
